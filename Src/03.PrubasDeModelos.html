<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Nuevo modelo</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="03.PrubasDeModelos_files/libs/clipboard/clipboard.min.js"></script>
<script src="03.PrubasDeModelos_files/libs/quarto-html/quarto.js"></script>
<script src="03.PrubasDeModelos_files/libs/quarto-html/popper.min.js"></script>
<script src="03.PrubasDeModelos_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="03.PrubasDeModelos_files/libs/quarto-html/anchor.min.js"></script>
<link href="03.PrubasDeModelos_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="03.PrubasDeModelos_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="03.PrubasDeModelos_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="03.PrubasDeModelos_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="03.PrubasDeModelos_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Nuevo modelo</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="librerias" class="level1">
<h1>Librerias</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.1     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survminer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: ggpubr

Attaching package: 'survminer'

The following object is masked from 'package:survival':

    myeloma</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xtable)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'kableExtra'

The following object is masked from 'package:dplyr':

    group_rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt) <span class="co"># Para una mejor visulización de las tablas</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra) <span class="co"># Para poner gráficos uno al lado del otro</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'gridExtra'

The following object is masked from 'package:dplyr':

    combine</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggcorrplot) <span class="co"># Para la creación del gráfico de correlación</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'scales'

The following object is masked from 'package:purrr':

    discard

The following object is masked from 'package:readr':

    col_factor</code></pre>
</div>
</div>
</section>
<section id="datos" class="level1">
<h1>Datos</h1>
</section>
<section id="análisis-exploratorio-de-los-datos" class="level1">
<h1>Análisis exploratorio de los datos</h1>
<p>La base de datos <em>Arkansas</em> está formada por 564 observaciones de las cuales se tomaron 23 variables, de las cuales usaremos X para nuestro estudio.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tmsxhfsacd" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#tmsxhfsacd table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#tmsxhfsacd thead, #tmsxhfsacd tbody, #tmsxhfsacd tfoot, #tmsxhfsacd tr, #tmsxhfsacd td, #tmsxhfsacd th {
  border-style: none;
}

#tmsxhfsacd p {
  margin: 0;
  padding: 0;
}

#tmsxhfsacd .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#tmsxhfsacd .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#tmsxhfsacd .gt_title {
  color: #333333;
  font-size: 18px;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#tmsxhfsacd .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#tmsxhfsacd .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tmsxhfsacd .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tmsxhfsacd .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tmsxhfsacd .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#tmsxhfsacd .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#tmsxhfsacd .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#tmsxhfsacd .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#tmsxhfsacd .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#tmsxhfsacd .gt_spanner_row {
  border-bottom-style: hidden;
}

#tmsxhfsacd .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#tmsxhfsacd .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#tmsxhfsacd .gt_from_md > :first-child {
  margin-top: 0;
}

#tmsxhfsacd .gt_from_md > :last-child {
  margin-bottom: 0;
}

#tmsxhfsacd .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#tmsxhfsacd .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#tmsxhfsacd .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#tmsxhfsacd .gt_row_group_first td {
  border-top-width: 2px;
}

#tmsxhfsacd .gt_row_group_first th {
  border-top-width: 2px;
}

#tmsxhfsacd .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tmsxhfsacd .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#tmsxhfsacd .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#tmsxhfsacd .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tmsxhfsacd .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tmsxhfsacd .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#tmsxhfsacd .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#tmsxhfsacd .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#tmsxhfsacd .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tmsxhfsacd .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tmsxhfsacd .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tmsxhfsacd .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tmsxhfsacd .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tmsxhfsacd .gt_left {
  text-align: left;
}

#tmsxhfsacd .gt_center {
  text-align: center;
}

#tmsxhfsacd .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#tmsxhfsacd .gt_font_normal {
  font-weight: normal;
}

#tmsxhfsacd .gt_font_bold {
  font-weight: bold;
}

#tmsxhfsacd .gt_font_italic {
  font-style: italic;
}

#tmsxhfsacd .gt_super {
  font-size: 65%;
}

#tmsxhfsacd .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#tmsxhfsacd .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#tmsxhfsacd .gt_indent_1 {
  text-indent: 5px;
}

#tmsxhfsacd .gt_indent_2 {
  text-indent: 10px;
}

#tmsxhfsacd .gt_indent_3 {
  text-indent: 15px;
}

#tmsxhfsacd .gt_indent_4 {
  text-indent: 20px;
}

#tmsxhfsacd .gt_indent_5 {
  text-indent: 25px;
}

#tmsxhfsacd .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#tmsxhfsacd div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_heading">
<th colspan="3" class="gt_heading gt_title gt_font_normal gt_bottom_border">Variables de estudio</th>
</tr>
<tr class="odd gt_col_headings">
<th id="nombres_variables" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Variable</th>
<th id="variable_usada" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Usada</th>
<th id="explicacion" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Explicación</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="nombres_variables">original order</td>
<td class="gt_row gt_left" headers="variable_usada">No</td>
<td class="gt_row gt_left" headers="explicacion">Orden de los datos</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="nombres_variables">PATID</td>
<td class="gt_row gt_left" headers="variable_usada">No</td>
<td class="gt_row gt_left" headers="explicacion">Identificación Paciente</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="nombres_variables">PROT</td>
<td class="gt_row gt_left" headers="variable_usada">Si</td>
<td class="gt_row gt_left" headers="explicacion">Tratamiento Recibido ("TT2" o "TT3")</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="nombres_variables">SEX</td>
<td class="gt_row gt_left" headers="variable_usada">Si</td>
<td class="gt_row gt_left" headers="explicacion">Sexo del paciente ("male" o "female")</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="nombres_variables">RACE</td>
<td class="gt_row gt_left" headers="variable_usada">No</td>
<td class="gt_row gt_left" headers="explicacion">Raza del paciente ("white" o "other")</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="nombres_variables">ISOTYPE</td>
<td class="gt_row gt_left" headers="variable_usada">No (de momento)</td>
<td class="gt_row gt_left" headers="explicacion">Isotipo del paciente ("IgA" , "IgG", "IgM" o "IgE")</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="nombres_variables">AGE</td>
<td class="gt_row gt_left" headers="variable_usada">Si</td>
<td class="gt_row gt_left" headers="explicacion">Edad del paciente (en meses)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="nombres_variables">B2M</td>
<td class="gt_row gt_left" headers="variable_usada">Si</td>
<td class="gt_row gt_left" headers="explicacion">Niveles de Microglobulina beta-2 (en mg/l)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="nombres_variables">CRP</td>
<td class="gt_row gt_left" headers="variable_usada">Si</td>
<td class="gt_row gt_left" headers="explicacion">Niveles de Proteína C-Reactiva (en mg/l)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="nombres_variables">CREAT</td>
<td class="gt_row gt_left" headers="variable_usada">Si</td>
<td class="gt_row gt_left" headers="explicacion">Niveles de Creatinina (en mg/dl)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="nombres_variables">LDH</td>
<td class="gt_row gt_left" headers="variable_usada">Si</td>
<td class="gt_row gt_left" headers="explicacion">Niveles de Lactato Deshidrogenasa (en U/l)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="nombres_variables">ALB</td>
<td class="gt_row gt_left" headers="variable_usada">Si</td>
<td class="gt_row gt_left" headers="explicacion">Niveles de Albúmina (en g/l)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="nombres_variables">HGB</td>
<td class="gt_row gt_left" headers="variable_usada">Si</td>
<td class="gt_row gt_left" headers="explicacion">Niveles de Hemoglobina (en g/dl)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="nombres_variables">ASPC</td>
<td class="gt_row gt_left" headers="variable_usada">Si</td>
<td class="gt_row gt_left" headers="explicacion">Células plasmáticas en aspirado de médula ósea</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="nombres_variables">BMPC</td>
<td class="gt_row gt_left" headers="variable_usada">Si</td>
<td class="gt_row gt_left" headers="explicacion">Células plasmáticas en biopsia de médula ósea</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="nombres_variables">MRI</td>
<td class="gt_row gt_left" headers="variable_usada">Si</td>
<td class="gt_row gt_left" headers="explicacion">Número de lesiones focales</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="nombres_variables">Cyto_Abn</td>
<td class="gt_row gt_left" headers="variable_usada">Si</td>
<td class="gt_row gt_left" headers="explicacion">Indica si presenta mutaciones citogenéticas (0 = No , 1 = Sí)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="nombres_variables">CPS1</td>
<td class="gt_row gt_left" headers="variable_usada">No</td>
<td class="gt_row gt_left" headers="explicacion">Variable sin contexto</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="nombres_variables">CPR1</td>
<td class="gt_row gt_left" headers="variable_usada">No</td>
<td class="gt_row gt_left" headers="explicacion">Variable sin contexto</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="nombres_variables">EFS_Censor</td>
<td class="gt_row gt_left" headers="variable_usada">No (de momento)</td>
<td class="gt_row gt_left" headers="explicacion">Indica si el paciente ha recaido (0 = No | 1 = Sí)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="nombres_variables">EFS_Time</td>
<td class="gt_row gt_left" headers="variable_usada">No (de momento)</td>
<td class="gt_row gt_left" headers="explicacion">Tiempo sin recaer (en meses)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="nombres_variables">OS_Censor</td>
<td class="gt_row gt_left" headers="variable_usada">Si</td>
<td class="gt_row gt_left" headers="explicacion">Indica si el paciente falleció (0 = No | 1 = Sí)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="nombres_variables">OS_Time</td>
<td class="gt_row gt_left" headers="variable_usada">Si</td>
<td class="gt_row gt_left" headers="explicacion">Tiempo de supervivencia (en meses)</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Algunos de los pacientes presentan censura, es decir, en su último control, este, no había fallecido. Además, algunas de las observaciones tienen datos faltantes, veamos cuales son estas variables y cuantos datos faltan para cada una y contabilicemos el nivel de censura que presentan los datos.</p>
<div class="cell">
<div class="cell-output-display">
<div id="skzjpnonry" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#skzjpnonry table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#skzjpnonry thead, #skzjpnonry tbody, #skzjpnonry tfoot, #skzjpnonry tr, #skzjpnonry td, #skzjpnonry th {
  border-style: none;
}

#skzjpnonry p {
  margin: 0;
  padding: 0;
}

#skzjpnonry .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#skzjpnonry .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#skzjpnonry .gt_title {
  color: #333333;
  font-size: 18px;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#skzjpnonry .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#skzjpnonry .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#skzjpnonry .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#skzjpnonry .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#skzjpnonry .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#skzjpnonry .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#skzjpnonry .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#skzjpnonry .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#skzjpnonry .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#skzjpnonry .gt_spanner_row {
  border-bottom-style: hidden;
}

#skzjpnonry .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#skzjpnonry .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#skzjpnonry .gt_from_md > :first-child {
  margin-top: 0;
}

#skzjpnonry .gt_from_md > :last-child {
  margin-bottom: 0;
}

#skzjpnonry .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#skzjpnonry .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#skzjpnonry .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#skzjpnonry .gt_row_group_first td {
  border-top-width: 2px;
}

#skzjpnonry .gt_row_group_first th {
  border-top-width: 2px;
}

#skzjpnonry .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#skzjpnonry .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#skzjpnonry .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#skzjpnonry .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#skzjpnonry .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#skzjpnonry .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#skzjpnonry .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#skzjpnonry .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#skzjpnonry .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#skzjpnonry .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#skzjpnonry .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#skzjpnonry .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#skzjpnonry .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#skzjpnonry .gt_left {
  text-align: left;
}

#skzjpnonry .gt_center {
  text-align: center;
}

#skzjpnonry .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#skzjpnonry .gt_font_normal {
  font-weight: normal;
}

#skzjpnonry .gt_font_bold {
  font-weight: bold;
}

#skzjpnonry .gt_font_italic {
  font-style: italic;
}

#skzjpnonry .gt_super {
  font-size: 65%;
}

#skzjpnonry .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#skzjpnonry .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#skzjpnonry .gt_indent_1 {
  text-indent: 5px;
}

#skzjpnonry .gt_indent_2 {
  text-indent: 10px;
}

#skzjpnonry .gt_indent_3 {
  text-indent: 15px;
}

#skzjpnonry .gt_indent_4 {
  text-indent: 20px;
}

#skzjpnonry .gt_indent_5 {
  text-indent: 25px;
}

#skzjpnonry .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#skzjpnonry div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_heading">
<th colspan="2" class="gt_heading gt_title gt_font_normal gt_bottom_border">Datos faltantes por variable</th>
</tr>
<tr class="odd gt_col_headings">
<th id="Variable" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Variable</th>
<th id="Faltantes" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Datos faltantes</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Variable">MRI</td>
<td class="gt_row gt_right" headers="Faltantes">37</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Variable">ASPC</td>
<td class="gt_row gt_right" headers="Faltantes">28</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Variable">ISOTYPE</td>
<td class="gt_row gt_right" headers="Faltantes">26</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Variable">BMPC</td>
<td class="gt_row gt_right" headers="Faltantes">16</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Variable">CRP</td>
<td class="gt_row gt_right" headers="Faltantes">4</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Variable">CREAT</td>
<td class="gt_row gt_right" headers="Faltantes">3</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Variable">B2M</td>
<td class="gt_row gt_right" headers="Faltantes">1</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>También es interesante determinar si los niveles de las variables clínicas se encuentran en niveles sanos. Para eso, añadimos a nuestra base de datos estas variables. Los niveles sanos de las diferentes variables se han obtenido de MayoClinic y MedlinePlus.</p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03.PrubasDeModelos_files/figure-html/B2M-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03.PrubasDeModelos_files/figure-html/CREAT-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03.PrubasDeModelos_files/figure-html/CREAT-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03.PrubasDeModelos_files/figure-html/CRP-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03.PrubasDeModelos_files/figure-html/LDH-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03.PrubasDeModelos_files/figure-html/ALB-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03.PrubasDeModelos_files/figure-html/HGB-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03.PrubasDeModelos_files/figure-html/HGB-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03.PrubasDeModelos_files/figure-html/AGE-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>grafico_AGE <span class="ot">=</span> Arkansas <span class="sc">%&gt;%</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> AGE)) <span class="sc">+</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..count..), <span class="at">fill =</span> <span class="st">"#1f78b4"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Añadir los valores encima de cada barra</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">stat =</span> <span class="st">"bin"</span>, <span class="fu">aes</span>(<span class="at">label =</span> ..count.., <span class="at">y =</span> ..count.. <span class="sc">+</span> <span class="fl">1.5</span>), <span class="at">size =</span> <span class="dv">4</span>, <span class="at">position =</span> <span class="fu">position_identity</span>()) <span class="sc">+</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Títulos</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribución de AGE"</span>) <span class="sc">+</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Edad (en años)"</span>, <span class="at">y =</span> <span class="st">"Frecuencia"</span>) <span class="sc">+</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">pretty_breaks</span>(<span class="at">n =</span> <span class="dv">10</span>)) <span class="sc">+</span> </span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() </span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Gira el gráfico a horizontal</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>grafico_AGE</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The dot-dot notation (`..count..`) was deprecated in ggplot2 3.4.0.
ℹ Please use `after_stat(count)` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03.PrubasDeModelos_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Arkansas, <span class="fu">aes</span>(<span class="at">x =</span> AGE)) <span class="sc">+</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">5</span>, <span class="at">fill =</span> <span class="st">"#56B4E9"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribución de la Edad"</span>, <span class="at">x =</span> <span class="st">"Edad (en meses)"</span>, <span class="at">y =</span> <span class="st">"Frecuencia"</span>) <span class="sc">+</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">quantile</span>(Arkansas<span class="sc">$</span>AGE, <span class="fl">0.25</span>), <span class="at">y =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">yend =</span> <span class="dv">115</span> , <span class="at">xend =</span> <span class="fu">quantile</span>(Arkansas<span class="sc">$</span>AGE, <span class="fl">0.25</span>)), <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>, <span class="at">x =</span> <span class="fu">quantile</span>(Arkansas<span class="sc">$</span>AGE, <span class="fl">0.25</span>), <span class="at">y =</span> <span class="dv">120</span>, <span class="at">label =</span> <span class="st">"Q1"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Use of `Arkansas$AGE` is discouraged.
ℹ Use `AGE` instead.
Use of `Arkansas$AGE` is discouraged.
ℹ Use `AGE` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_segment(aes(x = quantile(Arkansas$AGE, 0.25), y = -1, yend = 115, : All aesthetics have length 1, but the data has 564 rows.
ℹ Please consider using `annotate()` or provide this layer with data containing
  a single row.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03.PrubasDeModelos_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="variables-categoricas" class="level4">
<h4 class="anchored" data-anchor-id="variables-categoricas">Variables categoricas</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear el gráfico de barras</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">na.omit</span>(Arkansas), <span class="fu">aes</span>(<span class="at">x =</span> ISOTYPE)) <span class="sc">+</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">"#56B4E9"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Añadir las frecuencias sobre cada barra</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">stat =</span> <span class="st">"count"</span>, <span class="fu">aes</span>(<span class="at">label =</span> ..count..), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Mejorar la estética del gráfico</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribución de ISOTYPE"</span>, <span class="at">x =</span> <span class="st">"Isotipo"</span>, <span class="at">y =</span> <span class="st">"Frecuencia"</span>) <span class="sc">+</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="fu">max</span>(<span class="fu">table</span>(Arkansas<span class="sc">$</span>ISOTYPE)) <span class="sc">*</span> <span class="fl">1.1</span>) <span class="sc">+</span>  <span class="co"># Aumenta el límite del eje y un 10%</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>)</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03.PrubasDeModelos_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear el gráfico de barras</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">na.omit</span>(Arkansas), <span class="fu">aes</span>(<span class="at">x =</span> RACE)) <span class="sc">+</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">"#56B4E9"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Añadir las frecuencias sobre cada barra</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">stat =</span> <span class="st">"count"</span>, <span class="fu">aes</span>(<span class="at">label =</span> ..count..), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Mejorar la estética del gráfico</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribución de RACE"</span>, <span class="at">x =</span> <span class="st">"Raza"</span>, <span class="at">y =</span> <span class="st">"Frecuencia"</span>) <span class="sc">+</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="fu">max</span>(<span class="fu">table</span>(Arkansas<span class="sc">$</span>RACE)) <span class="sc">*</span> <span class="fl">1.1</span>) <span class="sc">+</span>  <span class="co"># Aumenta el límite del eje y un 10%</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>)</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03.PrubasDeModelos_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Arkansas, <span class="fu">aes</span>(<span class="at">x =</span> Cyto_Abn)) <span class="sc">+</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Diagrama de Barras de Cyto_Abn"</span>, <span class="at">x =</span> <span class="st">"Alteraciones Citogenéticas"</span>, <span class="at">y =</span> <span class="st">"Frecuencia"</span>) <span class="sc">+</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Sin alteraciones"</span>, <span class="st">"Con alteraciones"</span>)) <span class="sc">+</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">stat =</span> <span class="st">"count"</span>, <span class="fu">aes</span>(<span class="at">label =</span> ..count..), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">400</span>)<span class="sc">+</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>)</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03.PrubasDeModelos_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Seleccionar las variables de interés y omitir los NA</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>variables_interes <span class="ot">&lt;-</span> Arkansas[,<span class="dv">7</span><span class="sc">:</span><span class="dv">16</span>] <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular la matriz de correlación</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>matriz_correlacion <span class="ot">&lt;-</span> <span class="fu">cor</span>(variables_interes)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Generar el gráfico de correlación</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcorrplot</span>(matriz_correlacion, </span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">hc.order =</span> <span class="cn">TRUE</span>,         <span class="co"># Ordenar jerárquicamente</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">type =</span> <span class="st">"lower"</span>,          <span class="co"># Mostrar solo la mitad inferior</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">lab =</span> <span class="cn">TRUE</span>,              <span class="co"># Añadir los valores de correlación</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">lab_size =</span> <span class="fl">3.5</span>,          <span class="co"># Tamaño del texto de los valores</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">colors =</span> <span class="fu">c</span>(<span class="st">"#4575b4"</span>, <span class="st">"#f7f7f7"</span>, <span class="st">"#d73027"</span>)) <span class="sc">+</span>  <span class="co"># Colores personalizados</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Mapa de Correlación de Variables"</span>) <span class="sc">+</span>    <span class="co"># Añadir título</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Variables"</span>, <span class="at">y =</span> <span class="st">"Variables"</span>) <span class="sc">+</span>         <span class="co"># Títulos de los ejes</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">16</span>),   <span class="co"># Centrar el título y ajustar tamaño</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),   <span class="co"># Tamaño del título del eje x</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>))   <span class="co"># Tamaño del título del eje y</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03.PrubasDeModelos_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="modelo-de-cox-sin-datos-faltantes" class="level1">
<h1>MODELO DE COX <u>SIN DATOS FALTANTES</u></h1>
<p>Para la primera sección, trabajaremos sin los datos faltantes. Definimos un nuevo data frame eliminando estas observaciones.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Consideramos la base de datos sin datos faltantes.</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>Arkansas_SinDatosFaltantes <span class="ot">=</span> <span class="fu">na.omit</span>(Arkansas)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>Arkansas_SinDatosFaltantes <span class="ot">=</span> Arkansas_SinDatosFaltantes[<span class="sc">!</span>Arkansas_SinDatosFaltantes<span class="sc">$</span>ISOTYPE <span class="sc">==</span> <span class="st">"Nonsecretory"</span>,]</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Hay que convertir la Variable ISOTYPE en variables "dummies"</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>Arkansas_SinDatosFaltantes <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span>ISOTYPE <span class="sc">-</span> <span class="dv">1</span>, <span class="at">data =</span> Arkansas_SinDatosFaltantes) <span class="sc">%&gt;%</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(Arkansas_SinDatosFaltantes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Calculamos, para cada variable, un modelo de Cox univariable para observar la significancia individual que tienen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>covariates <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"AGE"</span>, <span class="st">"SEX"</span>, <span class="st">"PROT"</span> ,<span class="st">"B2M"</span>, <span class="st">"ISOTYPEFLC"</span>, <span class="st">"ISOTYPEIgA"</span>, <span class="st">"ISOTYPEIgD"</span>, <span class="st">"ISOTYPEIgG"</span>, <span class="st">"RACE"</span> ,<span class="st">"CRP"</span>, <span class="st">"CREAT"</span>,<span class="st">"LDH"</span>,<span class="st">"ALB"</span>,<span class="st">"HGB"</span>, <span class="st">"ASPC"</span>,<span class="st">"BMPC"</span>, <span class="st">"MRI"</span>,<span class="st">"Cyto_Abn"</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>univ_formulas <span class="ot">&lt;-</span> <span class="fu">sapply</span>(covariates,</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">function</span>(x) <span class="fu">as.formula</span>(<span class="fu">paste</span>(<span class="st">'Surv(OS_Time, OS_Censor)~'</span>, x)))</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>univ_models <span class="ot">&lt;-</span> <span class="fu">lapply</span>( univ_formulas, <span class="cf">function</span>(x){<span class="fu">coxph</span>(x, <span class="at">data =</span> Arkansas_SinDatosFaltantes)})</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract data </span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>univ_results <span class="ot">&lt;-</span> <span class="fu">lapply</span>(univ_models,</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>                       <span class="cf">function</span>(x){ </span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>                          x <span class="ot">&lt;-</span> <span class="fu">summary</span>(x)</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>                          p.value<span class="ot">&lt;-</span><span class="fu">signif</span>(x<span class="sc">$</span>wald[<span class="st">"pvalue"</span>], <span class="at">digits=</span><span class="dv">2</span>)</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>                          wald.test<span class="ot">&lt;-</span><span class="fu">signif</span>(x<span class="sc">$</span>wald[<span class="st">"test"</span>], <span class="at">digits=</span><span class="dv">2</span>)</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>                          beta<span class="ot">&lt;-</span><span class="fu">signif</span>(x<span class="sc">$</span>coef[<span class="dv">1</span>], <span class="at">digits=</span><span class="dv">2</span>);<span class="co">#coeficient beta</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>                          HR <span class="ot">&lt;-</span><span class="fu">signif</span>(x<span class="sc">$</span>coef[<span class="dv">2</span>], <span class="at">digits=</span><span class="dv">2</span>);<span class="co">#exp(beta)</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>                          HR.confint.lower <span class="ot">&lt;-</span> <span class="fu">signif</span>(x<span class="sc">$</span>conf.int[,<span class="st">"lower .95"</span>], <span class="dv">2</span>)</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>                          HR.confint.upper <span class="ot">&lt;-</span> <span class="fu">signif</span>(x<span class="sc">$</span>conf.int[,<span class="st">"upper .95"</span>],<span class="dv">2</span>)</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>                          HR <span class="ot">&lt;-</span> <span class="fu">paste0</span>(HR, <span class="st">" ("</span>, </span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>                                       HR.confint.lower, <span class="st">"-"</span>, HR.confint.upper, <span class="st">")"</span>)</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>                          res<span class="ot">&lt;-</span><span class="fu">c</span>(beta, HR, wald.test, p.value)</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">names</span>(res)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"beta"</span>, <span class="st">"HR (95% CI for HR)"</span>, <span class="st">"wald.test"</span>, </span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"p.value"</span>)</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">return</span>(res)</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>                          <span class="co">#return(exp(cbind(coef(x),confint(x))))</span></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>                         })</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">as.data.frame</span>(univ_results, <span class="at">check.names =</span> <span class="cn">FALSE</span>))</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             beta HR (95% CI for HR) wald.test p.value
AGE          0.02            1 (1-1)       5.5   0.019
SEX        -0.047    0.95 (0.69-1.3)      0.08    0.77
PROT        -0.17    0.84 (0.57-1.3)      0.71     0.4
B2M         0.069      1.1 (1.1-1.1)        73 1.3e-17
ISOTYPEFLC -0.034    0.97 (0.61-1.5)      0.02    0.88
ISOTYPEIgA 0.0063       1 (0.71-1.4)         0    0.97
ISOTYPEIgD  -0.25    0.78 (0.11-5.6)      0.06    0.81
ISOTYPEIgG  0.019       1 (0.74-1.4)      0.01    0.91
RACE        0.037       1 (0.63-1.7)      0.02    0.89
CRP         0.006            1 (1-1)       3.2   0.072
CREAT        0.23      1.3 (1.2-1.4)        32   2e-08
LDH        0.0057            1 (1-1)        39 4.6e-10
ALB         -0.59   0.56 (0.43-0.71)        21 3.9e-06
HGB         -0.16   0.86 (0.78-0.93)        12 0.00044
ASPC        0.012            1 (1-1)        13 0.00025
BMPC        0.011            1 (1-1)        13 0.00025
MRI         0.014            1 (1-1)       9.6  0.0019
Cyto_Abn     0.82      2.3 (1.7-3.1)        26 3.3e-07</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generar el archivo LaTeX con la tabla</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>tabla_latex <span class="ot">&lt;-</span> <span class="fu">xtable</span>(res, <span class="at">caption =</span> <span class="st">"Descripción del modelo univariante"</span>, <span class="at">label =</span> <span class="st">"Tabla: Cox Univariante"</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Guardar el archivo LaTeX en un archivo .tex</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tabla_latex, <span class="at">file =</span> <span class="st">"/Users/marc/Downloads/TFG/R/TFGMarcArrom/Output/Graphs_tables/tabla_cox_univariante.tex"</span>, <span class="at">include.rownames =</span> <span class="cn">TRUE</span>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>observaciones_con_censura <span class="ot">=</span> <span class="fu">sum</span>(Arkansas<span class="sc">$</span>OS_Censor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="análisis-del-modelo-univariable" class="level4">
<h4 class="anchored" data-anchor-id="análisis-del-modelo-univariable">Análisis del modelo univariable</h4>
<p>El P.valor de las variables de SEX, PROT, CRP y ISOTYPE nos indica que el nivel de sinificancia en el riesgo de muerte no es relevante.</p>
<p>Por otra parte, tenemos otras variables que si contribuyen al riesgo de muerte, como son la AGE, el ASPC, BMPC, MRI, HGB.</p>
<p>Por último, los variables con mayor signifinacia son B2M, CREAT, LDH, ALB y Cyto_Abn.</p>
<p>Aunque la edad aparece con una signifancia “media”, hay que tener en cuenta que la mayoria de los individuos, el 75% de ellos, tienen más de 50 años. Por lo que, en la base de datos, no tenemos suficientes individuos para representar a la población joven.</p>
<p>Realicemos un estudio para determinar cual de las 13 variables consideradas son significativas para construir el modelo.</p>
<p>Realizamos ahora, con las variables significativas, un modelo multivariante</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajustar el modelo de Cox</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(OS_Time, OS_Censor) <span class="sc">~</span> B2M <span class="sc">+</span> CREAT <span class="sc">+</span> LDH <span class="sc">+</span> ALB <span class="sc">+</span> Cyto_Abn <span class="sc">+</span> AGE <span class="sc">+</span> ASPC <span class="sc">+</span> BMPC <span class="sc">+</span> MRI <span class="sc">+</span> HGB, <span class="at">data =</span> Arkansas)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Resumir el modelo</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>mod1_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(mod1)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear un dataframe con los coeficientes y otras estadísticas de interés</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>tabla_cox <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">coef =</span> <span class="fu">round</span>(mod1_summary<span class="sc">$</span>coefficients[, <span class="st">"coef"</span>], <span class="dv">5</span>),</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">exp_coef =</span> <span class="fu">round</span>(mod1_summary<span class="sc">$</span>coefficients[, <span class="st">"exp(coef)"</span>], <span class="dv">5</span>),</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">se_coef =</span> <span class="fu">round</span>(mod1_summary<span class="sc">$</span>coefficients[, <span class="st">"se(coef)"</span>], <span class="dv">5</span>),</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">z =</span> <span class="fu">round</span>(mod1_summary<span class="sc">$</span>coefficients[, <span class="st">"z"</span>], <span class="dv">3</span>),</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">p_value =</span> mod1_summary<span class="sc">$</span>coefficients[, <span class="st">"Pr(&gt;|z|)"</span>]</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Cambiar los nombres de las columnas para que sean más comprensibles</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tabla_cox) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Coeficiente Beta"</span>, <span class="st">"Exp(Coef)"</span>, <span class="st">"Error Estándar"</span>, <span class="st">"Z-valor"</span>, <span class="st">"P-valor"</span>)</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar la tabla generada</span></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tabla_cox)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Coeficiente Beta Exp(Coef) Error Estándar Z-valor      P-valor
B2M               0.04497   1.04599        0.01684   2.671 0.0075638104
CREAT            -0.00223   0.99777        0.08064  -0.028 0.9779283560
LDH               0.00400   1.00401        0.00108   3.717 0.0002016106
ALB              -0.41228   0.66214        0.13751  -2.998 0.0027168232
Cyto_Abn          0.59320   1.80977        0.16989   3.492 0.0004798284
AGE               0.01713   1.01727        0.00878   1.951 0.0510688243
ASPC             -0.00231   0.99769        0.00494  -0.467 0.6402239650
BMPC              0.00265   1.00265        0.00469   0.565 0.5718389160
MRI               0.01245   1.01253        0.00475   2.624 0.0086960314
HGB              -0.04053   0.96028        0.05287  -0.767 0.4433349069</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear la tabla y guardarla en un archivo PDF</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(tabla_cox, <span class="at">format =</span> <span class="st">"latex"</span>, <span class="at">booktabs =</span> <span class="cn">TRUE</span>, <span class="at">caption =</span> <span class="st">"Resultados del modelo de Cox"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">latex_options =</span> <span class="fu">c</span>(<span class="st">"hold_position"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">save_kable</span>(<span class="st">"/Users/marc/Downloads/TFG/R/TFGMarcArrom/Output/Graphs_tables/tabla_cox_multivariante.tex"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Observamos que cuando combinamos las variables más significativas, algunas de obtienen un valor muy elevado, destaca el caso de la CREAT, que obtiene un p-valor muy próximo a 1.</p>
<p>Esto, es debido a la <strong>multicolinealidad</strong>, es dicir, a que hay variables que tienen un alto grado de correlación con otras y el modelo no es capaz de identificar cual de las dos variables es la que es significativa en el modelo.</p>
<p>Para la selección de las variables y evitar la multicolinealidad, usaremos el método de <strong>selección hacia atrás</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajustar el modelo inicial con todas las variables</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>modelo_inicial <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(OS_Time, OS_Censor) <span class="sc">~</span> AGE <span class="sc">+</span> SEX <span class="sc">+</span> PROT <span class="sc">+</span> B2M <span class="sc">+</span> ISOTYPEFLC <span class="sc">+</span> ISOTYPEIgA <span class="sc">+</span> ISOTYPEIgD <span class="sc">+</span> ISOTYPEIgG <span class="sc">+</span> CRP <span class="sc">+</span> CREAT <span class="sc">+</span> LDH <span class="sc">+</span> ALB <span class="sc">+</span> HGB <span class="sc">+</span> ASPC <span class="sc">+</span> BMPC <span class="sc">+</span> MRI <span class="sc">+</span> Cyto_Abn, <span class="at">data =</span> Arkansas_SinDatosFaltantes)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Aplicar selección hacia atrás</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>modelo_backward <span class="ot">&lt;-</span> <span class="fu">step</span>(modelo_inicial, <span class="at">direction =</span> <span class="st">"backward"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=1717.11
Surv(OS_Time, OS_Censor) ~ AGE + SEX + PROT + B2M + ISOTYPEFLC + 
    ISOTYPEIgA + ISOTYPEIgD + ISOTYPEIgG + CRP + CREAT + LDH + 
    ALB + HGB + ASPC + BMPC + MRI + Cyto_Abn


Step:  AIC=1717.11
Surv(OS_Time, OS_Censor) ~ AGE + SEX + PROT + B2M + ISOTYPEFLC + 
    ISOTYPEIgA + ISOTYPEIgD + CRP + CREAT + LDH + ALB + HGB + 
    ASPC + BMPC + MRI + Cyto_Abn

             Df    AIC
- ISOTYPEIgD  1 1715.1
- CREAT       1 1715.1
- ISOTYPEIgA  1 1715.2
- CRP         1 1715.2
- PROT        1 1715.2
- SEX         1 1715.2
- ASPC        1 1715.4
- BMPC        1 1715.5
- HGB         1 1715.6
- ISOTYPEFLC  1 1716.8
&lt;none&gt;          1717.1
- AGE         1 1718.4
- ALB         1 1720.1
- MRI         1 1721.9
- B2M         1 1723.7
- Cyto_Abn    1 1724.9
- LDH         1 1727.9

Step:  AIC=1715.12
Surv(OS_Time, OS_Censor) ~ AGE + SEX + PROT + B2M + ISOTYPEFLC + 
    ISOTYPEIgA + CRP + CREAT + LDH + ALB + HGB + ASPC + BMPC + 
    MRI + Cyto_Abn

             Df    AIC
- CREAT       1 1713.2
- CRP         1 1713.2
- ISOTYPEIgA  1 1713.2
- PROT        1 1713.2
- SEX         1 1713.2
- ASPC        1 1713.4
- BMPC        1 1713.5
- HGB         1 1713.6
- ISOTYPEFLC  1 1714.8
&lt;none&gt;          1715.1
- AGE         1 1716.4
- ALB         1 1718.1
- MRI         1 1719.9
- B2M         1 1721.7
- Cyto_Abn    1 1723.0
- LDH         1 1725.9

Step:  AIC=1713.15
Surv(OS_Time, OS_Censor) ~ AGE + SEX + PROT + B2M + ISOTYPEFLC + 
    ISOTYPEIgA + CRP + LDH + ALB + HGB + ASPC + BMPC + MRI + 
    Cyto_Abn

             Df    AIC
- CRP         1 1711.2
- ISOTYPEIgA  1 1711.2
- PROT        1 1711.2
- SEX         1 1711.2
- ASPC        1 1711.5
- BMPC        1 1711.5
- HGB         1 1711.6
- ISOTYPEFLC  1 1712.8
&lt;none&gt;          1713.2
- AGE         1 1714.5
- ALB         1 1716.2
- MRI         1 1717.9
- Cyto_Abn    1 1721.1
- LDH         1 1723.9
- B2M         1 1727.1

Step:  AIC=1711.2
Surv(OS_Time, OS_Censor) ~ AGE + SEX + PROT + B2M + ISOTYPEFLC + 
    ISOTYPEIgA + LDH + ALB + HGB + ASPC + BMPC + MRI + Cyto_Abn

             Df    AIC
- ISOTYPEIgA  1 1709.3
- PROT        1 1709.3
- SEX         1 1709.3
- ASPC        1 1709.5
- BMPC        1 1709.6
- HGB         1 1709.6
- ISOTYPEFLC  1 1710.8
&lt;none&gt;          1711.2
- AGE         1 1712.6
- ALB         1 1714.3
- MRI         1 1715.9
- Cyto_Abn    1 1719.1
- LDH         1 1722.0
- B2M         1 1725.2

Step:  AIC=1709.26
Surv(OS_Time, OS_Censor) ~ AGE + SEX + PROT + B2M + ISOTYPEFLC + 
    LDH + ALB + HGB + ASPC + BMPC + MRI + Cyto_Abn

             Df    AIC
- SEX         1 1707.3
- PROT        1 1707.3
- ASPC        1 1707.5
- BMPC        1 1707.7
- HGB         1 1707.7
- ISOTYPEFLC  1 1709.2
&lt;none&gt;          1709.3
- AGE         1 1710.6
- ALB         1 1712.4
- MRI         1 1714.2
- Cyto_Abn    1 1717.1
- LDH         1 1720.0
- B2M         1 1723.4

Step:  AIC=1707.32
Surv(OS_Time, OS_Censor) ~ AGE + PROT + B2M + ISOTYPEFLC + LDH + 
    ALB + HGB + ASPC + BMPC + MRI + Cyto_Abn

             Df    AIC
- PROT        1 1705.4
- ASPC        1 1705.6
- BMPC        1 1705.7
- HGB         1 1705.7
&lt;none&gt;          1707.3
- ISOTYPEFLC  1 1707.4
- AGE         1 1708.6
- ALB         1 1710.5
- MRI         1 1712.7
- Cyto_Abn    1 1715.4
- LDH         1 1718.0
- B2M         1 1721.4

Step:  AIC=1705.39
Surv(OS_Time, OS_Censor) ~ AGE + B2M + ISOTYPEFLC + LDH + ALB + 
    HGB + ASPC + BMPC + MRI + Cyto_Abn

             Df    AIC
- ASPC        1 1703.6
- BMPC        1 1703.8
- HGB         1 1703.8
&lt;none&gt;          1705.4
- ISOTYPEFLC  1 1705.5
- AGE         1 1706.7
- ALB         1 1708.6
- MRI         1 1710.7
- Cyto_Abn    1 1713.4
- LDH         1 1716.5
- B2M         1 1719.6

Step:  AIC=1703.64
Surv(OS_Time, OS_Censor) ~ AGE + B2M + ISOTYPEFLC + LDH + ALB + 
    HGB + BMPC + MRI + Cyto_Abn

             Df    AIC
- BMPC        1 1701.8
- HGB         1 1702.0
&lt;none&gt;          1703.6
- ISOTYPEFLC  1 1703.7
- AGE         1 1704.8
- ALB         1 1706.8
- MRI         1 1709.0
- Cyto_Abn    1 1711.4
- LDH         1 1714.6
- B2M         1 1717.7

Step:  AIC=1701.78
Surv(OS_Time, OS_Censor) ~ AGE + B2M + ISOTYPEFLC + LDH + ALB + 
    HGB + MRI + Cyto_Abn

             Df    AIC
- HGB         1 1700.3
&lt;none&gt;          1701.8
- ISOTYPEFLC  1 1702.0
- AGE         1 1703.0
- ALB         1 1705.0
- MRI         1 1707.1
- Cyto_Abn    1 1710.2
- LDH         1 1713.1
- B2M         1 1717.0

Step:  AIC=1700.27
Surv(OS_Time, OS_Censor) ~ AGE + B2M + ISOTYPEFLC + LDH + ALB + 
    MRI + Cyto_Abn

             Df    AIC
&lt;none&gt;          1700.3
- ISOTYPEFLC  1 1700.6
- AGE         1 1701.3
- ALB         1 1705.2
- MRI         1 1705.3
- Cyto_Abn    1 1708.7
- LDH         1 1712.0
- B2M         1 1717.4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Resumir el modelo final ajustado</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>modelo_backward_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(modelo_backward)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(modelo_backward_summary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(OS_Time, OS_Censor) ~ AGE + B2M + ISOTYPEFLC + 
    LDH + ALB + MRI + Cyto_Abn, data = Arkansas_SinDatosFaltantes)

  n= 467, number of events= 156 

                coef exp(coef)  se(coef)      z Pr(&gt;|z|)    
AGE         0.015161  1.015276  0.008732  1.736  0.08254 .  
B2M         0.052499  1.053902  0.010700  4.906 9.27e-07 ***
ISOTYPEFLC -0.427669  0.652028  0.290049 -1.474  0.14035    
LDH         0.004279  1.004288  0.001077  3.973 7.09e-05 ***
ALB        -0.359426  0.698077  0.134855 -2.665  0.00769 ** 
MRI         0.013373  1.013463  0.004822  2.773  0.00555 ** 
Cyto_Abn    0.547436  1.728815  0.169374  3.232  0.00123 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

           exp(coef) exp(-coef) lower .95 upper .95
AGE           1.0153     0.9850    0.9980    1.0328
B2M           1.0539     0.9489    1.0320    1.0762
ISOTYPEFLC    0.6520     1.5337    0.3693    1.1512
LDH           1.0043     0.9957    1.0022    1.0064
ALB           0.6981     1.4325    0.5359    0.9093
MRI           1.0135     0.9867    1.0039    1.0231
Cyto_Abn      1.7288     0.5784    1.2404    2.4095

Concordance= 0.728  (se = 0.02 )
Likelihood ratio test= 94.98  on 7 df,   p=&lt;2e-16
Wald test            = 118.8  on 7 df,   p=&lt;2e-16
Score (logrank) test = 138.2  on 7 df,   p=&lt;2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear un dataframe con los coeficientes y estadísticas del modelo ajustado</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>tabla_backward <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">coef =</span> <span class="fu">formatC</span>(modelo_backward_summary<span class="sc">$</span>coefficients[, <span class="st">"coef"</span>], <span class="dv">5</span>),</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">exp_coef =</span> <span class="fu">formatC</span>(modelo_backward_summary<span class="sc">$</span>coefficients[, <span class="st">"exp(coef)"</span>], <span class="at">format =</span> <span class="st">"g"</span>, <span class="at">digits =</span> <span class="dv">5</span>),</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">se_coef =</span> <span class="fu">formatC</span>(modelo_backward_summary<span class="sc">$</span>coefficients[, <span class="st">"se(coef)"</span>], <span class="at">format =</span> <span class="st">"g"</span>, <span class="at">digits =</span> <span class="dv">5</span>),</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">z =</span> <span class="fu">formatC</span>(modelo_backward_summary<span class="sc">$</span>coefficients[, <span class="st">"z"</span>], <span class="at">format =</span> <span class="st">"g"</span>, <span class="at">digits =</span> <span class="dv">5</span>),</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">p_value =</span> <span class="fu">formatC</span>(modelo_backward_summary<span class="sc">$</span>coefficients[, <span class="st">"Pr(&gt;|z|)"</span>], <span class="at">format =</span> <span class="st">"g"</span>, <span class="at">digits =</span> <span class="dv">2</span>  )</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Renombrar las columnas para mayor claridad</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tabla_backward) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Coeficiente"</span>, <span class="st">"Exp(Coef)"</span>, <span class="st">"Error Estándar"</span>, <span class="st">"Z-valor"</span>, <span class="st">"P-valor"</span>)</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar la tabla generada</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tabla_backward)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Coeficiente Exp(Coef) Error Estándar Z-valor P-valor
AGE           0.015161    1.0153      0.0087324  1.7362   0.083
B2M           0.052499    1.0539         0.0107  4.9065 9.3e-07
ISOTYPEFLC    -0.42767   0.65203        0.29005 -1.4745    0.14
LDH          0.0042789    1.0043      0.0010769  3.9734 7.1e-05
ALB           -0.35943   0.69808        0.13485 -2.6653  0.0077
MRI           0.013373    1.0135      0.0048225   2.773  0.0056
Cyto_Abn       0.54744    1.7288        0.16937  3.2321  0.0012</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convertir la tabla a formato LaTeX</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>tabla_latex <span class="ot">&lt;-</span> <span class="fu">xtable</span>(tabla_backward, <span class="at">caption =</span> <span class="st">"Resultados del modelo final después de selección hacia atrás"</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Guardar la tabla en un archivo .tex para Overleaf</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tabla_latex, <span class="at">file =</span> <span class="st">"/Users/marc/Downloads/TFG/R/TFGMarcArrom/Output/Graphs_tables/tabla_cox_backward.tex"</span>, <span class="at">include.rownames =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Estadístico de decisión de las variables</p>
<p>Comparisons between a number of possible models, which need not nec- essarily be nested, can also be made on the basis of Akaike’s information criterion, given by AIC = −2 log Lˆ + 2q, in which q is the number of unknown β-parameters in the model. The smaller the value of this statistic, the better the model, but unlike the −2 log Lˆ statis- tic, the value of AIC will tend to increase when unnecessary terms are added to the model.</p>
<p>ANÁLISIS DEL MÓDELO “FINAL”</p>
<p>age: El coeficiente es positivo (0.016140), lo que sugiere que un aumento en la edad incrementa ligeramente el riesgo, pero el valor p (0.063447) indica que el efecto es marginalmente significativo (cercano a 0.05, pero no lo suficiente). B2M: Tiene un coeficiente positivo (0.045930), lo que indica que el aumento en B2M incrementa el riesgo de manera significativa (p = 2.81e-06). Su HR es 1.047, lo que significa que por cada unidad adicional en B2M, el riesgo aumenta en un 4.7%. LDH: También tiene un coeficiente positivo y es altamente significativo (p = 0.000197). Un aumento en LDH incrementa el riesgo, aunque en menor magnitud, un 0.04% (HR = 1.004). ALB: El coeficiente es negativo (-0.438302), lo que significa que un aumento en la albúmina disminuye el riesgo. Es un efecto significativo (p = 0.000637) y el HR de 0.645131 indica una reducción del 35.49% en el riesgo por cada unidad adicional de albúmina. MRI: Tiene un coeficiente positivo y significativo (p = 0.013479), indicando que un aumento en los valores de MRI incrementa el riesgo (HR = 1.011635). Cyto_Abn: Tiene un coeficiente positivo (0.604041), lo que indica que la presencia de anomalías citogenéticas aumenta significativamente el riesgo (p = 0.000283), con un HR de 1.829496, es decir, el riesgo se incrementa en un 82.95%.</p>
<p>GRÁFICO QUE MUESTRA COMO SE VAN ELIMINANDO LAS VARIABLES</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear manualmente el data frame con las variables y las iteraciones</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>variables <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"PROT"</span>,<span class="st">"Age"</span>, <span class="st">"Sex"</span>, <span class="st">"B2M"</span>, <span class="st">"CRP"</span>, <span class="st">"CREAT"</span>, <span class="st">"LDH"</span>, <span class="st">"ALB"</span>, <span class="st">"HGB"</span>, <span class="st">"ASPC"</span>, <span class="st">"BMPC"</span>, <span class="st">"MRI"</span>, <span class="st">"Cyto_Abn"</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Asignar en qué iteración fue eliminada cada variable (0 si no fue eliminada)</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>eliminadas_iteracion <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">8</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear el data frame con las variables y las iteraciones de eliminación</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> variables, <span class="at">Iteracion_Eliminada =</span> eliminadas_iteracion)</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Máximo número de iteraciones (ajusta según tu caso)</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>max_iter <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear un nuevo data frame para indicar presencia (1) o eliminación (0)</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>iteraciones_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">rep</span>(variables, <span class="at">each =</span> max_iter),</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>                             <span class="at">Iteracion =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>max_iter, <span class="at">times =</span> <span class="fu">length</span>(variables)),</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>                             <span class="at">Status =</span> <span class="dv">1</span>)</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Modificar el status a 0 cuando la variable fue eliminada</span></span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(df)) {</span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (df<span class="sc">$</span>Iteracion_Eliminada[i] <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>    iteraciones_df<span class="sc">$</span>Status[iteraciones_df<span class="sc">$</span>Variable <span class="sc">==</span> df<span class="sc">$</span>Variableble[i] <span class="sc">&amp;</span> </span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>                          iteraciones_df<span class="sc">$</span>Iteracion <span class="sc">&gt;=</span> df<span class="sc">$</span>Iteracion_Eliminada[i]] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtrar sólo las filas donde la variable aún está presente (Status == 1)</span></span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>iteraciones_df <span class="ot">&lt;-</span> iteraciones_df[iteraciones_df<span class="sc">$</span>Status <span class="sc">==</span> <span class="dv">1</span>, ]</span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear el gráfico con líneas horizontales para cada variable</span></span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iteraciones_df, <span class="fu">aes</span>(<span class="at">x =</span> Iteracion, <span class="at">y =</span> Variable)) <span class="sc">+</span></span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Variable), <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span>  <span class="co"># Colorear cada variable de forma distinta</span></span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Proceso de eliminación de variables manual"</span>,</span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Iteraciones"</span>, </span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Variables"</span>) <span class="sc">+</span></span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, max_iter, <span class="at">by =</span> <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)  <span class="co"># Eliminar leyenda si no es necesaria</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03.PrubasDeModelos_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Gráfico del modelo de Cox</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>  curva_supervivencia <span class="ot">&lt;-</span> <span class="fu">survfit</span>(modelo_backward)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Graficar las curvas</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsurvplot</span>(curva_supervivencia, <span class="at">data =</span> Arkansas, </span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">conf.int =</span> <span class="cn">TRUE</span>,          <span class="co"># Añadir intervalo de confianza</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">pval =</span> <span class="cn">TRUE</span>,              <span class="co"># Mostrar valor p</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">risk.table =</span> <span class="cn">TRUE</span>,        <span class="co"># Mostrar tabla de riesgos</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">ggtheme =</span> <span class="fu">theme_minimal</span>(),<span class="co"># Tema estético</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"#E69F00"</span>, <span class="st">"#56B4E9"</span>))  <span class="co"># Colores personalizables</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in .pvalue(fit, data = data, method = method, pval = pval, pval.coord = pval.coord, : There are no survival curves to be compared. 
 This is a null model.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03.PrubasDeModelos_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear el objeto gráfico</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>curva_supervivencia <span class="ot">&lt;-</span> <span class="fu">survfit</span>(modelo_backward)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear el gráfico</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>plot_supervivencia <span class="ot">&lt;-</span> <span class="fu">ggsurvplot</span>(curva_supervivencia, </span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">data =</span> Arkansas, </span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">conf.int =</span> <span class="cn">TRUE</span>,          <span class="co"># Añadir intervalo de confianza</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">risk.table =</span> <span class="cn">FALSE</span>,        <span class="co"># Mostrar tabla de riesgos</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">ggtheme =</span> <span class="fu">theme_minimal</span>(),<span class="co"># Tema estético</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"#E69F00"</span>, <span class="st">"#56B4E9"</span>), <span class="co"># Colores personalizables</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">legend =</span> <span class="st">"none"</span>,</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">title =</span> <span class="st">"MODELO DE COX </span><span class="sc">\"</span><span class="st">BACKWARD</span><span class="sc">\"</span><span class="st"> "</span>,</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">xlab =</span> <span class="st">"Tiempo (en meses)"</span>,</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">ylab =</span> <span class="st">"Probabilidad de superviviencia"</span></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>                                 )  </span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Guardar el gráfico como PDF</span></span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"/Users/marc/Downloads/TFG/R/TFGMarcArrom/Output/Graphs_tables/grafico_modeloCoxBackward_VarCompletas.pdf"</span>, </span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> plot_supervivencia<span class="sc">$</span>plot,  <span class="co"># Extraer solo el gráfico principal</span></span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">7</span>, <span class="at">device =</span> <span class="st">"pdf"</span>)  <span class="co"># Ajusta el tamaño y formato</span></span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot_supervivencia)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03.PrubasDeModelos_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="gráficos-kaplan-meier" class="level1">
<h1>Gráficos Kaplan-Meier</h1>
<section id="preparación-de-los-datos" class="level2">
<h2 class="anchored" data-anchor-id="preparación-de-los-datos">Preparación de los datos</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargar la librería dplyr</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Dataset transformado con nuevas columnas que indican si están en el rango (0) o fuera del rango (1)</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>datosEstratificados <span class="ot">&lt;-</span> Arkansas <span class="sc">%&gt;%</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">AGE_flag =</span> <span class="fu">ifelse</span>(AGE <span class="sc">&lt;=</span> <span class="dv">50</span>, <span class="dv">0</span>, <span class="dv">1</span>),  </span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">B2M_flag =</span> <span class="fu">ifelse</span>(B2M <span class="sc">&lt;=</span> <span class="fl">2.7</span>, <span class="dv">0</span>, <span class="dv">1</span>),  </span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">CREAT_flag =</span> <span class="fu">ifelse</span>(SEX <span class="sc">==</span> <span class="st">"male"</span> <span class="sc">&amp;</span> CREAT <span class="sc">&gt;=</span> <span class="fl">0.74</span> <span class="sc">&amp;</span> CREAT <span class="sc">&lt;=</span> <span class="fl">1.35</span>, <span class="dv">0</span>, </span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">ifelse</span>(SEX <span class="sc">==</span> <span class="st">"female"</span> <span class="sc">&amp;</span> CREAT <span class="sc">&gt;=</span> <span class="fl">0.54</span> <span class="sc">&amp;</span> CREAT <span class="sc">&lt;=</span> <span class="fl">1.04</span>, <span class="dv">0</span>, <span class="dv">1</span>)),</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">LDH_flag =</span> <span class="fu">ifelse</span>(LDH <span class="sc">&gt;=</span> <span class="dv">122</span> <span class="sc">&amp;</span> LDH <span class="sc">&lt;=</span> <span class="dv">222</span>, <span class="dv">0</span>, <span class="dv">1</span>),  </span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">ALB_flag =</span> <span class="fu">ifelse</span>(ALB <span class="sc">&gt;=</span> <span class="fl">3.5</span> <span class="sc">&amp;</span> ALB <span class="sc">&lt;=</span> <span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">1</span>),     </span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Para MRI no hay niveles normales, lo dividimos por quantiles</span></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">MRI_flag =</span> <span class="fu">ifelse</span>(MRI <span class="sc">&lt;=</span> <span class="fu">quantile</span>(<span class="fu">na.omit</span>(Arkansas<span class="sc">$</span>MRI), <span class="fl">0.25</span>),<span class="dv">0</span>,</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">ifelse</span>(MRI <span class="sc">&gt;=</span> <span class="fu">quantile</span>(<span class="fu">na.omit</span>(Arkansas<span class="sc">$</span>MRI), <span class="fl">0.25</span>) <span class="sc">&amp;</span> MRI <span class="sc">&lt;=</span> <span class="fu">quantile</span>(<span class="fu">na.omit</span>(Arkansas<span class="sc">$</span>MRI), <span class="fl">0.75</span>),<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar las primeras filas del nuevo dataset</span></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(datosEstratificados, <span class="dv">30</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 30 × 31
   `original order` PATID PROT  SEX    RACE  ISOTYPE       AGE   B2M   CRP CREAT
              &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1                1  8241 TT2   female white IgG          53.4   1.8   8.6   0.6
 2                2  9843 TT2   female white IgG          52.7   1.7   8.9   0.6
 3                3  9888 TT2   male   white Nonsecreto…  62.0   5.5   4.5   0.8
 4                4  9835 TT2   male   white IgA          60.3   2.8   9.9   1  
 5                5  9997 TT2   male   white IgG          66.9   4     2.6   1.2
 6                6  9992 TT2   female white IgA          55.3   2.9   2.1   1  
 7                7 10003 TT2   male   white FLC          57.1   3.1  32.5   0.7
 8                8 10021 TT2   male   other IgG          55.9   1.7   8.6   0.8
 9                9  9983 TT2   male   white IgG          54.5   2.5   0.2   1.1
10               10 10107 TT2   male   white IgA          59.7   3.3   1.8   1  
# ℹ 20 more rows
# ℹ 21 more variables: LDH &lt;dbl&gt;, ALB &lt;dbl&gt;, HGB &lt;dbl&gt;, ASPC &lt;dbl&gt;, BMPC &lt;dbl&gt;,
#   MRI &lt;dbl&gt;, Cyto_Abn &lt;dbl&gt;, CPS1 &lt;dbl&gt;, CPR1 &lt;dbl&gt;, EFS_Censor &lt;dbl&gt;,
#   EFS_Time &lt;dbl&gt;, OS_Censor &lt;dbl&gt;, OS_Time &lt;dbl&gt;, AGE_flag &lt;dbl&gt;,
#   B2M_flag &lt;dbl&gt;, CREAT_flag &lt;dbl&gt;, CRP_flag &lt;dbl&gt;, LDH_flag &lt;dbl&gt;,
#   ALB_flag &lt;dbl&gt;, MRI_flag &lt;dbl&gt;, HGB_flag &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(datosEstratificados[datosEstratificados<span class="sc">$</span>CREAT_flag <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> datosEstratificados<span class="sc">$</span>B2M_flag <span class="sc">==</span> <span class="dv">0</span>,])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 216</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajustar el modelo de supervivencia</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear el gráfico de supervivencia</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsurvplot</span>(</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">survfit</span>(<span class="fu">Surv</span>(OS_Time, OS_Censor) <span class="sc">~</span> AGE_flag, <span class="at">data =</span> Arkansas), </span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> datosEstratificados, </span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">pval =</span> <span class="cn">TRUE</span>,</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"#0072B2"</span>, <span class="st">"#D95F02"</span>, <span class="st">"#F0E442"</span>, <span class="st">"#999999"</span>)  <span class="co"># Define la paleta de colores</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03.PrubasDeModelos_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsurvplot</span>(</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">survfit</span>(<span class="fu">Surv</span>(OS_Time, OS_Censor) <span class="sc">~</span> B2M_flag, <span class="at">data =</span> Arkansas), </span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> datosEstratificados, </span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">pval =</span> <span class="cn">TRUE</span>,</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"#0072B2"</span>, <span class="st">"#D95F02"</span>, <span class="st">"#F0E442"</span>, <span class="st">"#999999"</span>)  <span class="co"># Define la paleta de colores</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03.PrubasDeModelos_files/figure-html/unnamed-chunk-20-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsurvplot</span>(</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">survfit</span>(<span class="fu">Surv</span>(OS_Time, OS_Censor) <span class="sc">~</span> ALB_flag, <span class="at">data =</span> Arkansas), </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> datosEstratificados, </span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">pval =</span> <span class="cn">TRUE</span>,</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"#0072B2"</span>, <span class="st">"#D95F02"</span>, <span class="st">"#F0E442"</span>, <span class="st">"#999999"</span>)  <span class="co"># Define la paleta de colores</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03.PrubasDeModelos_files/figure-html/unnamed-chunk-20-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsurvplot</span>(</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">survfit</span>(<span class="fu">Surv</span>(OS_Time, OS_Censor) <span class="sc">~</span> LDH_flag, <span class="at">data =</span> Arkansas), </span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> datosEstratificados, </span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">pval =</span> <span class="cn">TRUE</span>,</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"#0072B2"</span>, <span class="st">"#D95F02"</span>, <span class="st">"#F0E442"</span>, <span class="st">"#999999"</span>)  <span class="co"># Define la paleta de colores</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03.PrubasDeModelos_files/figure-html/unnamed-chunk-20-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsurvplot</span>(</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">survfit</span>(<span class="fu">Surv</span>(OS_Time, OS_Censor) <span class="sc">~</span> MRI_flag, <span class="at">data =</span> datosEstratificados), </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> datosEstratificados, </span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">pval =</span> <span class="cn">TRUE</span>,</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"#0072B2"</span>, <span class="st">"#D95F02"</span>, <span class="st">"#F0E442"</span>, <span class="st">"#999999"</span>)  <span class="co"># Define la paleta de colores</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03.PrubasDeModelos_files/figure-html/unnamed-chunk-20-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargar el paquete survival</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajustar modelos paramétricos con distintas distribuciones</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>modelo_exp <span class="ot">&lt;-</span> <span class="fu">survreg</span>(<span class="fu">Surv</span>(OS_Time, OS_Censor) <span class="sc">~</span> AGE <span class="sc">+</span> SEX <span class="sc">+</span> PROT <span class="sc">+</span> B2M <span class="sc">+</span> ISOTYPEFLC <span class="sc">+</span> </span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>                      ISOTYPEIgA <span class="sc">+</span> ISOTYPEIgD <span class="sc">+</span> ISOTYPEIgG <span class="sc">+</span> CRP <span class="sc">+</span> CREAT <span class="sc">+</span> LDH <span class="sc">+</span> ALB <span class="sc">+</span> </span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>                      HGB <span class="sc">+</span> ASPC <span class="sc">+</span> BMPC <span class="sc">+</span> MRI <span class="sc">+</span> Cyto_Abn, <span class="at">data =</span> Arkansas_SinDatosFaltantes, <span class="at">dist =</span> <span class="st">"exponential"</span>)</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>modelo_exp_backward <span class="ot">&lt;-</span> <span class="fu">step</span>(modelo_exp, <span class="at">direction =</span> <span class="st">"backward"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=1814.42
Surv(OS_Time, OS_Censor) ~ AGE + SEX + PROT + B2M + ISOTYPEFLC + 
    ISOTYPEIgA + ISOTYPEIgD + ISOTYPEIgG + CRP + CREAT + LDH + 
    ALB + HGB + ASPC + BMPC + MRI + Cyto_Abn

             Df    AIC
- ISOTYPEFLC  1 1812.4
- ISOTYPEIgA  1 1812.4
- ISOTYPEIgD  1 1812.4
- ISOTYPEIgG  1 1812.4
- CRP         1 1812.5
- CREAT       1 1812.5
- SEX         1 1812.5
- ASPC        1 1812.7
- HGB         1 1812.9
- BMPC        1 1812.9
- PROT        1 1813.3
&lt;none&gt;          1814.4
- AGE         1 1815.5
- ALB         1 1817.1
- MRI         1 1819.1
- B2M         1 1820.5
- Cyto_Abn    1 1821.9
- LDH         1 1824.4

Step:  AIC=1812.42
Surv(OS_Time, OS_Censor) ~ AGE + SEX + PROT + B2M + ISOTYPEIgA + 
    ISOTYPEIgD + ISOTYPEIgG + CRP + CREAT + LDH + ALB + HGB + 
    ASPC + BMPC + MRI + Cyto_Abn

             Df    AIC
- CRP         1 1810.5
- ISOTYPEIgD  1 1810.5
- CREAT       1 1810.5
- SEX         1 1810.5
- ASPC        1 1810.7
- HGB         1 1810.9
- BMPC        1 1810.9
- PROT        1 1811.3
- ISOTYPEIgG  1 1812.0
- ISOTYPEIgA  1 1812.2
&lt;none&gt;          1812.4
- AGE         1 1813.5
- ALB         1 1815.1
- MRI         1 1817.1
- B2M         1 1818.5
- Cyto_Abn    1 1819.9
- LDH         1 1822.4

Step:  AIC=1810.45
Surv(OS_Time, OS_Censor) ~ AGE + SEX + PROT + B2M + ISOTYPEIgA + 
    ISOTYPEIgD + ISOTYPEIgG + CREAT + LDH + ALB + HGB + ASPC + 
    BMPC + MRI + Cyto_Abn

             Df    AIC
- ISOTYPEIgD  1 1808.5
- CREAT       1 1808.5
- SEX         1 1808.5
- ASPC        1 1808.8
- HGB         1 1808.9
- BMPC        1 1808.9
- PROT        1 1809.3
- ISOTYPEIgG  1 1810.0
- ISOTYPEIgA  1 1810.2
&lt;none&gt;          1810.5
- AGE         1 1811.6
- ALB         1 1813.2
- MRI         1 1815.1
- B2M         1 1816.5
- Cyto_Abn    1 1817.9
- LDH         1 1820.5

Step:  AIC=1808.53
Surv(OS_Time, OS_Censor) ~ AGE + SEX + PROT + B2M + ISOTYPEIgA + 
    ISOTYPEIgG + CREAT + LDH + ALB + HGB + ASPC + BMPC + MRI + 
    Cyto_Abn

             Df    AIC
- CREAT       1 1806.6
- SEX         1 1806.6
- ASPC        1 1806.8
- HGB         1 1807.0
- BMPC        1 1807.0
- PROT        1 1807.4
- ISOTYPEIgG  1 1808.0
- ISOTYPEIgA  1 1808.2
&lt;none&gt;          1808.5
- AGE         1 1809.7
- ALB         1 1811.3
- MRI         1 1813.2
- B2M         1 1814.5
- Cyto_Abn    1 1815.9
- LDH         1 1818.5

Step:  AIC=1806.6
Surv(OS_Time, OS_Censor) ~ AGE + SEX + PROT + B2M + ISOTYPEIgA + 
    ISOTYPEIgG + LDH + ALB + HGB + ASPC + BMPC + MRI + Cyto_Abn

             Df    AIC
- SEX         1 1804.7
- ASPC        1 1804.9
- HGB         1 1805.0
- BMPC        1 1805.1
- PROT        1 1805.5
- ISOTYPEIgG  1 1806.1
- ISOTYPEIgA  1 1806.3
&lt;none&gt;          1806.6
- AGE         1 1807.9
- ALB         1 1809.5
- MRI         1 1811.2
- Cyto_Abn    1 1814.1
- LDH         1 1816.5
- B2M         1 1818.9

Step:  AIC=1804.68
Surv(OS_Time, OS_Censor) ~ AGE + PROT + B2M + ISOTYPEIgA + ISOTYPEIgG + 
    LDH + ALB + HGB + ASPC + BMPC + MRI + Cyto_Abn

             Df    AIC
- ASPC        1 1803.0
- HGB         1 1803.0
- BMPC        1 1803.2
- PROT        1 1803.5
- ISOTYPEIgG  1 1804.2
- ISOTYPEIgA  1 1804.4
&lt;none&gt;          1804.7
- AGE         1 1805.9
- ALB         1 1807.6
- MRI         1 1809.7
- Cyto_Abn    1 1812.4
- LDH         1 1814.5
- B2M         1 1816.9

Step:  AIC=1802.96
Surv(OS_Time, OS_Censor) ~ AGE + PROT + B2M + ISOTYPEIgA + ISOTYPEIgG + 
    LDH + ALB + HGB + BMPC + MRI + Cyto_Abn

             Df    AIC
- BMPC        1 1801.2
- HGB         1 1801.2
- PROT        1 1801.7
- ISOTYPEIgG  1 1802.5
- ISOTYPEIgA  1 1802.7
&lt;none&gt;          1803.0
- AGE         1 1804.1
- ALB         1 1805.8
- MRI         1 1808.0
- Cyto_Abn    1 1810.4
- LDH         1 1812.6
- B2M         1 1815.0

Step:  AIC=1801.2
Surv(OS_Time, OS_Censor) ~ AGE + PROT + B2M + ISOTYPEIgA + ISOTYPEIgG + 
    LDH + ALB + HGB + MRI + Cyto_Abn

             Df    AIC
- HGB         1 1799.7
- PROT        1 1800.0
- ISOTYPEIgG  1 1800.8
- ISOTYPEIgA  1 1801.1
&lt;none&gt;          1801.2
- AGE         1 1802.4
- ALB         1 1804.2
- MRI         1 1806.3
- Cyto_Abn    1 1809.4
- LDH         1 1811.2
- B2M         1 1814.4

Step:  AIC=1799.7
Surv(OS_Time, OS_Censor) ~ AGE + PROT + B2M + ISOTYPEIgA + ISOTYPEIgG + 
    LDH + ALB + MRI + Cyto_Abn

             Df    AIC
- PROT        1 1798.4
- ISOTYPEIgG  1 1799.3
&lt;none&gt;          1799.7
- ISOTYPEIgA  1 1799.8
- AGE         1 1800.7
- MRI         1 1804.4
- ALB         1 1804.5
- Cyto_Abn    1 1808.0
- LDH         1 1810.1
- B2M         1 1814.7

Step:  AIC=1798.41
Surv(OS_Time, OS_Censor) ~ AGE + B2M + ISOTYPEIgA + ISOTYPEIgG + 
    LDH + ALB + MRI + Cyto_Abn

             Df    AIC
- ISOTYPEIgG  1 1798.2
&lt;none&gt;          1798.4
- ISOTYPEIgA  1 1798.8
- AGE         1 1799.3
- MRI         1 1803.0
- ALB         1 1803.2
- Cyto_Abn    1 1806.6
- LDH         1 1809.9
- B2M         1 1813.5

Step:  AIC=1798.19
Surv(OS_Time, OS_Censor) ~ AGE + B2M + ISOTYPEIgA + LDH + ALB + 
    MRI + Cyto_Abn

             Df    AIC
- ISOTYPEIgA  1 1796.9
&lt;none&gt;          1798.2
- AGE         1 1799.5
- MRI         1 1801.6
- ALB         1 1806.6
- LDH         1 1808.3
- Cyto_Abn    1 1808.7
- B2M         1 1811.5

Step:  AIC=1796.86
Surv(OS_Time, OS_Censor) ~ AGE + B2M + LDH + ALB + MRI + Cyto_Abn

           Df    AIC
&lt;none&gt;        1796.9
- AGE       1 1798.1
- MRI       1 1800.2
- ALB       1 1804.8
- LDH       1 1806.5
- Cyto_Abn  1 1807.6
- B2M       1 1810.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>modelo_weibull <span class="ot">&lt;-</span> <span class="fu">survreg</span>(<span class="fu">Surv</span>(OS_Time, OS_Censor) <span class="sc">~</span> AGE <span class="sc">+</span> SEX <span class="sc">+</span> PROT <span class="sc">+</span> B2M <span class="sc">+</span> ISOTYPEFLC <span class="sc">+</span> </span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>                          ISOTYPEIgA <span class="sc">+</span> ISOTYPEIgD <span class="sc">+</span> ISOTYPEIgG <span class="sc">+</span> CRP <span class="sc">+</span> CREAT <span class="sc">+</span> LDH <span class="sc">+</span> ALB <span class="sc">+</span> </span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>                          HGB <span class="sc">+</span> ASPC <span class="sc">+</span> BMPC <span class="sc">+</span> MRI <span class="sc">+</span> Cyto_Abn, <span class="at">data =</span> Arkansas_SinDatosFaltantes, <span class="at">dist =</span> <span class="st">"weibull"</span>)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>modelo_weibull_backward <span class="ot">&lt;-</span> <span class="fu">step</span>(modelo_weibull, <span class="at">direction =</span> <span class="st">"backward"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=1811.1
Surv(OS_Time, OS_Censor) ~ AGE + SEX + PROT + B2M + ISOTYPEFLC + 
    ISOTYPEIgA + ISOTYPEIgD + ISOTYPEIgG + CRP + CREAT + LDH + 
    ALB + HGB + ASPC + BMPC + MRI + Cyto_Abn

             Df    AIC
- ISOTYPEFLC  1 1809.1
- ISOTYPEIgA  1 1809.1
- ISOTYPEIgD  1 1809.1
- ISOTYPEIgG  1 1809.1
- CRP         1 1809.1
- CREAT       1 1809.2
- SEX         1 1809.2
- PROT        1 1809.3
- ASPC        1 1809.5
- BMPC        1 1809.5
- HGB         1 1809.6
&lt;none&gt;          1811.1
- AGE         1 1812.4
- ALB         1 1814.3
- MRI         1 1816.2
- B2M         1 1818.1
- Cyto_Abn    1 1819.0
- LDH         1 1821.6

Step:  AIC=1809.1
Surv(OS_Time, OS_Censor) ~ AGE + SEX + PROT + B2M + ISOTYPEIgA + 
    ISOTYPEIgD + ISOTYPEIgG + CRP + CREAT + LDH + ALB + HGB + 
    ASPC + BMPC + MRI + Cyto_Abn

             Df    AIC
- CRP         1 1807.1
- ISOTYPEIgD  1 1807.2
- CREAT       1 1807.2
- SEX         1 1807.2
- PROT        1 1807.3
- ASPC        1 1807.5
- BMPC        1 1807.5
- HGB         1 1807.6
- ISOTYPEIgG  1 1808.9
&lt;none&gt;          1809.1
- ISOTYPEIgA  1 1809.2
- AGE         1 1810.4
- ALB         1 1812.3
- MRI         1 1814.2
- B2M         1 1816.1
- Cyto_Abn    1 1817.0
- LDH         1 1819.6

Step:  AIC=1807.13
Surv(OS_Time, OS_Censor) ~ AGE + SEX + PROT + B2M + ISOTYPEIgA + 
    ISOTYPEIgD + ISOTYPEIgG + CREAT + LDH + ALB + HGB + ASPC + 
    BMPC + MRI + Cyto_Abn

             Df    AIC
- CREAT       1 1805.2
- ISOTYPEIgD  1 1805.2
- SEX         1 1805.2
- PROT        1 1805.3
- ASPC        1 1805.5
- BMPC        1 1805.5
- HGB         1 1805.6
- ISOTYPEIgG  1 1806.9
&lt;none&gt;          1807.1
- ISOTYPEIgA  1 1807.2
- AGE         1 1808.5
- ALB         1 1810.4
- MRI         1 1812.2
- B2M         1 1814.1
- Cyto_Abn    1 1815.0
- LDH         1 1817.7

Step:  AIC=1805.21
Surv(OS_Time, OS_Censor) ~ AGE + SEX + PROT + B2M + ISOTYPEIgA + 
    ISOTYPEIgD + ISOTYPEIgG + LDH + ALB + HGB + ASPC + BMPC + 
    MRI + Cyto_Abn

             Df    AIC
- SEX         1 1803.3
- ISOTYPEIgD  1 1803.3
- PROT        1 1803.4
- ASPC        1 1803.6
- HGB         1 1803.6
- BMPC        1 1803.7
- ISOTYPEIgG  1 1805.0
&lt;none&gt;          1805.2
- ISOTYPEIgA  1 1805.3
- AGE         1 1806.7
- ALB         1 1808.6
- MRI         1 1810.3
- Cyto_Abn    1 1813.2
- LDH         1 1815.7
- B2M         1 1819.2

Step:  AIC=1803.29
Surv(OS_Time, OS_Censor) ~ AGE + PROT + B2M + ISOTYPEIgA + ISOTYPEIgD + 
    ISOTYPEIgG + LDH + ALB + HGB + ASPC + BMPC + MRI + Cyto_Abn

             Df    AIC
- ISOTYPEIgD  1 1801.4
- PROT        1 1801.5
- ASPC        1 1801.6
- HGB         1 1801.7
- BMPC        1 1801.7
- ISOTYPEIgG  1 1803.1
&lt;none&gt;          1803.3
- ISOTYPEIgA  1 1803.4
- AGE         1 1804.7
- ALB         1 1806.7
- MRI         1 1808.8
- Cyto_Abn    1 1811.5
- LDH         1 1813.7
- B2M         1 1817.2

Step:  AIC=1801.39
Surv(OS_Time, OS_Censor) ~ AGE + PROT + B2M + ISOTYPEIgA + ISOTYPEIgG + 
    LDH + ALB + HGB + ASPC + BMPC + MRI + Cyto_Abn

             Df    AIC
- PROT        1 1799.6
- ASPC        1 1799.7
- HGB         1 1799.8
- BMPC        1 1799.8
- ISOTYPEIgG  1 1801.1
&lt;none&gt;          1801.4
- ISOTYPEIgA  1 1801.4
- AGE         1 1802.9
- ALB         1 1804.9
- MRI         1 1806.9
- Cyto_Abn    1 1809.6
- LDH         1 1811.7
- B2M         1 1815.2

Step:  AIC=1799.61
Surv(OS_Time, OS_Censor) ~ AGE + B2M + ISOTYPEIgA + ISOTYPEIgG + 
    LDH + ALB + HGB + ASPC + BMPC + MRI + Cyto_Abn

             Df    AIC
- ASPC        1 1797.9
- HGB         1 1797.9
- BMPC        1 1798.0
- ISOTYPEIgG  1 1799.4
&lt;none&gt;          1799.6
- ISOTYPEIgA  1 1799.8
- AGE         1 1801.0
- ALB         1 1803.1
- MRI         1 1805.0
- Cyto_Abn    1 1807.7
- LDH         1 1810.5
- B2M         1 1813.5

Step:  AIC=1797.87
Surv(OS_Time, OS_Censor) ~ AGE + B2M + ISOTYPEIgA + ISOTYPEIgG + 
    LDH + ALB + HGB + BMPC + MRI + Cyto_Abn

             Df    AIC
- BMPC        1 1796.0
- HGB         1 1796.1
- ISOTYPEIgG  1 1797.7
&lt;none&gt;          1797.9
- ISOTYPEIgA  1 1798.0
- AGE         1 1799.2
- ALB         1 1801.3
- MRI         1 1803.3
- Cyto_Abn    1 1805.7
- LDH         1 1808.6
- B2M         1 1811.5

Step:  AIC=1796.03
Surv(OS_Time, OS_Censor) ~ AGE + B2M + ISOTYPEIgA + ISOTYPEIgG + 
    LDH + ALB + HGB + MRI + Cyto_Abn

             Df    AIC
- HGB         1 1794.4
- ISOTYPEIgG  1 1795.9
&lt;none&gt;          1796.0
- ISOTYPEIgA  1 1796.4
- AGE         1 1797.4
- ALB         1 1799.6
- MRI         1 1801.5
- Cyto_Abn    1 1804.5
- LDH         1 1807.1
- B2M         1 1810.9

Step:  AIC=1794.44
Surv(OS_Time, OS_Censor) ~ AGE + B2M + ISOTYPEIgA + ISOTYPEIgG + 
    LDH + ALB + MRI + Cyto_Abn

             Df    AIC
- ISOTYPEIgG  1 1794.3
&lt;none&gt;          1794.4
- ISOTYPEIgA  1 1795.0
- AGE         1 1795.7
- MRI         1 1799.6
- ALB         1 1800.0
- Cyto_Abn    1 1803.0
- LDH         1 1805.9
- B2M         1 1810.9

Step:  AIC=1794.3
Surv(OS_Time, OS_Censor) ~ AGE + B2M + ISOTYPEIgA + LDH + ALB + 
    MRI + Cyto_Abn

             Df    AIC
- ISOTYPEIgA  1 1793.0
&lt;none&gt;          1794.3
- AGE         1 1796.0
- MRI         1 1798.2
- ALB         1 1803.7
- LDH         1 1804.3
- Cyto_Abn    1 1805.3
- B2M         1 1808.9

Step:  AIC=1793.01
Surv(OS_Time, OS_Censor) ~ AGE + B2M + LDH + ALB + MRI + Cyto_Abn

           Df    AIC
&lt;none&gt;        1793.0
- AGE       1 1794.6
- MRI       1 1796.8
- ALB       1 1802.0
- LDH       1 1802.5
- Cyto_Abn  1 1804.2
- B2M       1 1807.6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>modelo_lognormal <span class="ot">&lt;-</span> <span class="fu">survreg</span>(<span class="fu">Surv</span>(OS_Time, OS_Censor) <span class="sc">~</span> AGE <span class="sc">+</span> SEX <span class="sc">+</span> PROT <span class="sc">+</span> B2M <span class="sc">+</span> ISOTYPEFLC <span class="sc">+</span> </span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>                            ISOTYPEIgA <span class="sc">+</span> ISOTYPEIgD <span class="sc">+</span> ISOTYPEIgG <span class="sc">+</span> CRP <span class="sc">+</span> CREAT <span class="sc">+</span> LDH <span class="sc">+</span> ALB <span class="sc">+</span> </span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>                            HGB <span class="sc">+</span> ASPC <span class="sc">+</span> BMPC <span class="sc">+</span> MRI <span class="sc">+</span> Cyto_Abn, <span class="at">data =</span> Arkansas_SinDatosFaltantes, <span class="at">dist =</span> <span class="st">"lognormal"</span>)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>modelo_lognormal_backward <span class="ot">&lt;-</span> <span class="fu">step</span>(modelo_lognormal, <span class="at">direction =</span> <span class="st">"backward"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=1806.23
Surv(OS_Time, OS_Censor) ~ AGE + SEX + PROT + B2M + ISOTYPEFLC + 
    ISOTYPEIgA + ISOTYPEIgD + ISOTYPEIgG + CRP + CREAT + LDH + 
    ALB + HGB + ASPC + BMPC + MRI + Cyto_Abn

             Df    AIC
- ISOTYPEIgA  1 1804.2
- ISOTYPEIgD  1 1804.2
- ISOTYPEFLC  1 1804.2
- ISOTYPEIgG  1 1804.2
- SEX         1 1804.2
- CRP         1 1804.3
- HGB         1 1804.4
- CREAT       1 1804.5
- ASPC        1 1804.7
&lt;none&gt;          1806.2
- PROT        1 1806.2
- BMPC        1 1806.7
- AGE         1 1807.9
- MRI         1 1810.0
- ALB         1 1810.6
- B2M         1 1812.1
- Cyto_Abn    1 1814.0
- LDH         1 1822.6

Step:  AIC=1804.23
Surv(OS_Time, OS_Censor) ~ AGE + SEX + PROT + B2M + ISOTYPEFLC + 
    ISOTYPEIgD + ISOTYPEIgG + CRP + CREAT + LDH + ALB + HGB + 
    ASPC + BMPC + MRI + Cyto_Abn

             Df    AIC
- SEX         1 1802.2
- ISOTYPEIgG  1 1802.2
- CRP         1 1802.3
- ISOTYPEIgD  1 1802.3
- HGB         1 1802.4
- CREAT       1 1802.5
- ISOTYPEFLC  1 1802.7
- ASPC        1 1802.7
&lt;none&gt;          1804.2
- PROT        1 1804.2
- BMPC        1 1804.7
- AGE         1 1805.9
- MRI         1 1808.0
- ALB         1 1808.6
- B2M         1 1810.1
- Cyto_Abn    1 1812.0
- LDH         1 1820.6

Step:  AIC=1802.24
Surv(OS_Time, OS_Censor) ~ AGE + PROT + B2M + ISOTYPEFLC + ISOTYPEIgD + 
    ISOTYPEIgG + CRP + CREAT + LDH + ALB + HGB + ASPC + BMPC + 
    MRI + Cyto_Abn

             Df    AIC
- ISOTYPEIgG  1 1800.2
- CRP         1 1800.3
- ISOTYPEIgD  1 1800.3
- HGB         1 1800.4
- CREAT       1 1800.5
- ISOTYPEFLC  1 1800.7
- ASPC        1 1800.7
- PROT        1 1802.2
&lt;none&gt;          1802.2
- BMPC        1 1802.7
- AGE         1 1803.9
- MRI         1 1806.2
- ALB         1 1806.6
- B2M         1 1808.3
- Cyto_Abn    1 1810.1
- LDH         1 1818.8

Step:  AIC=1800.25
Surv(OS_Time, OS_Censor) ~ AGE + PROT + B2M + ISOTYPEFLC + ISOTYPEIgD + 
    CRP + CREAT + LDH + ALB + HGB + ASPC + BMPC + MRI + Cyto_Abn

             Df    AIC
- CRP         1 1798.3
- ISOTYPEIgD  1 1798.3
- HGB         1 1798.4
- CREAT       1 1798.5
- ASPC        1 1798.7
- ISOTYPEFLC  1 1798.8
- PROT        1 1800.2
&lt;none&gt;          1800.2
- BMPC        1 1800.7
- AGE         1 1802.0
- MRI         1 1804.2
- ALB         1 1804.9
- B2M         1 1806.3
- Cyto_Abn    1 1808.1
- LDH         1 1816.9

Step:  AIC=1798.31
Surv(OS_Time, OS_Censor) ~ AGE + PROT + B2M + ISOTYPEFLC + ISOTYPEIgD + 
    CREAT + LDH + ALB + HGB + ASPC + BMPC + MRI + Cyto_Abn

             Df    AIC
- ISOTYPEIgD  1 1796.4
- HGB         1 1796.5
- CREAT       1 1796.5
- ASPC        1 1796.8
- ISOTYPEFLC  1 1796.9
- PROT        1 1798.3
&lt;none&gt;          1798.3
- BMPC        1 1798.8
- AGE         1 1800.0
- MRI         1 1802.2
- ALB         1 1803.1
- B2M         1 1804.4
- Cyto_Abn    1 1806.2
- LDH         1 1815.0

Step:  AIC=1796.39
Surv(OS_Time, OS_Censor) ~ AGE + PROT + B2M + ISOTYPEFLC + CREAT + 
    LDH + ALB + HGB + ASPC + BMPC + MRI + Cyto_Abn

             Df    AIC
- HGB         1 1794.6
- CREAT       1 1794.6
- ASPC        1 1794.8
- ISOTYPEFLC  1 1795.0
- PROT        1 1796.3
&lt;none&gt;          1796.4
- BMPC        1 1796.9
- AGE         1 1798.1
- MRI         1 1800.3
- ALB         1 1801.2
- B2M         1 1802.4
- Cyto_Abn    1 1804.4
- LDH         1 1813.1

Step:  AIC=1794.58
Surv(OS_Time, OS_Censor) ~ AGE + PROT + B2M + ISOTYPEFLC + CREAT + 
    LDH + ALB + ASPC + BMPC + MRI + Cyto_Abn

             Df    AIC
- CREAT       1 1792.8
- ISOTYPEFLC  1 1793.2
- ASPC        1 1793.2
&lt;none&gt;          1794.6
- PROT        1 1794.6
- BMPC        1 1794.9
- AGE         1 1796.4
- MRI         1 1798.7
- ALB         1 1799.3
- B2M         1 1800.4
- Cyto_Abn    1 1802.6
- LDH         1 1811.2

Step:  AIC=1792.83
Surv(OS_Time, OS_Censor) ~ AGE + PROT + B2M + ISOTYPEFLC + LDH + 
    ALB + ASPC + BMPC + MRI + Cyto_Abn

             Df    AIC
- ASPC        1 1791.4
- ISOTYPEFLC  1 1791.4
&lt;none&gt;          1792.8
- PROT        1 1792.9
- BMPC        1 1793.3
- AGE         1 1794.9
- MRI         1 1796.8
- ALB         1 1797.9
- Cyto_Abn    1 1800.9
- B2M         1 1805.9
- LDH         1 1809.3

Step:  AIC=1791.38
Surv(OS_Time, OS_Censor) ~ AGE + PROT + B2M + ISOTYPEFLC + LDH + 
    ALB + BMPC + MRI + Cyto_Abn

             Df    AIC
- ISOTYPEFLC  1 1789.9
- PROT        1 1791.2
&lt;none&gt;          1791.4
- BMPC        1 1791.5
- AGE         1 1793.4
- MRI         1 1795.7
- ALB         1 1796.3
- Cyto_Abn    1 1799.0
- B2M         1 1804.3
- LDH         1 1807.6

Step:  AIC=1789.91
Surv(OS_Time, OS_Censor) ~ AGE + PROT + B2M + LDH + ALB + BMPC + 
    MRI + Cyto_Abn

           Df    AIC
- PROT      1 1789.8
&lt;none&gt;        1789.9
- BMPC      1 1790.2
- AGE       1 1792.0
- MRI       1 1793.7
- ALB       1 1796.3
- Cyto_Abn  1 1798.4
- B2M       1 1802.3
- LDH       1 1805.6

Step:  AIC=1789.85
Surv(OS_Time, OS_Censor) ~ AGE + B2M + LDH + ALB + BMPC + MRI + 
    Cyto_Abn

           Df    AIC
&lt;none&gt;        1789.8
- BMPC      1 1790.3
- AGE       1 1791.5
- MRI       1 1793.4
- ALB       1 1796.0
- Cyto_Abn  1 1798.4
- B2M       1 1801.7
- LDH       1 1807.0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>modelo_loglogistic <span class="ot">&lt;-</span> <span class="fu">survreg</span>(<span class="fu">Surv</span>(OS_Time, OS_Censor) <span class="sc">~</span> AGE <span class="sc">+</span> SEX <span class="sc">+</span> PROT <span class="sc">+</span> B2M <span class="sc">+</span> ISOTYPEFLC <span class="sc">+</span> </span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>                              ISOTYPEIgA <span class="sc">+</span> ISOTYPEIgD <span class="sc">+</span> ISOTYPEIgG <span class="sc">+</span> CRP <span class="sc">+</span> CREAT <span class="sc">+</span> LDH <span class="sc">+</span> ALB <span class="sc">+</span> </span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>                              HGB <span class="sc">+</span> ASPC <span class="sc">+</span> BMPC <span class="sc">+</span> MRI <span class="sc">+</span> Cyto_Abn, <span class="at">data =</span> Arkansas_SinDatosFaltantes, <span class="at">dist =</span> <span class="st">"loglogistic"</span>)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>modelo_loglogistic_backward <span class="ot">&lt;-</span> <span class="fu">step</span>(modelo_loglogistic, <span class="at">direction =</span> <span class="st">"backward"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=1804.33
Surv(OS_Time, OS_Censor) ~ AGE + SEX + PROT + B2M + ISOTYPEFLC + 
    ISOTYPEIgA + ISOTYPEIgD + ISOTYPEIgG + CRP + CREAT + LDH + 
    ALB + HGB + ASPC + BMPC + MRI + Cyto_Abn

             Df    AIC
- ISOTYPEFLC  1 1802.3
- ISOTYPEIgA  1 1802.3
- ISOTYPEIgD  1 1802.3
- ISOTYPEIgG  1 1802.3
- SEX         1 1802.3
- HGB         1 1802.4
- CRP         1 1802.5
- CREAT       1 1802.7
- ASPC        1 1802.8
- PROT        1 1803.2
- BMPC        1 1803.7
&lt;none&gt;          1804.3
- AGE         1 1805.9
- ALB         1 1807.7
- MRI         1 1808.5
- B2M         1 1811.3
- Cyto_Abn    1 1813.0
- LDH         1 1821.1

Step:  AIC=1802.33
Surv(OS_Time, OS_Censor) ~ AGE + SEX + PROT + B2M + ISOTYPEIgA + 
    ISOTYPEIgD + ISOTYPEIgG + CRP + CREAT + LDH + ALB + HGB + 
    ASPC + BMPC + MRI + Cyto_Abn

             Df    AIC
- ISOTYPEIgD  1 1800.3
- SEX         1 1800.3
- HGB         1 1800.4
- CRP         1 1800.5
- CREAT       1 1800.7
- ASPC        1 1800.8
- ISOTYPEIgA  1 1801.1
- PROT        1 1801.2
- ISOTYPEIgG  1 1801.3
- BMPC        1 1801.7
&lt;none&gt;          1802.3
- AGE         1 1803.9
- ALB         1 1805.7
- MRI         1 1806.5
- B2M         1 1809.3
- Cyto_Abn    1 1811.0
- LDH         1 1819.1

Step:  AIC=1800.34
Surv(OS_Time, OS_Censor) ~ AGE + SEX + PROT + B2M + ISOTYPEIgA + 
    ISOTYPEIgG + CRP + CREAT + LDH + ALB + HGB + ASPC + BMPC + 
    MRI + Cyto_Abn

             Df    AIC
- SEX         1 1798.3
- HGB         1 1798.4
- CRP         1 1798.5
- CREAT       1 1798.7
- ASPC        1 1798.8
- ISOTYPEIgA  1 1799.2
- PROT        1 1799.2
- ISOTYPEIgG  1 1799.3
- BMPC        1 1799.7
&lt;none&gt;          1800.3
- AGE         1 1802.0
- ALB         1 1803.7
- MRI         1 1804.5
- B2M         1 1807.4
- Cyto_Abn    1 1809.0
- LDH         1 1817.1

Step:  AIC=1798.35
Surv(OS_Time, OS_Censor) ~ AGE + PROT + B2M + ISOTYPEIgA + ISOTYPEIgG + 
    CRP + CREAT + LDH + ALB + HGB + ASPC + BMPC + MRI + Cyto_Abn

             Df    AIC
- HGB         1 1796.4
- CRP         1 1796.5
- CREAT       1 1796.7
- ASPC        1 1796.8
- ISOTYPEIgA  1 1797.2
- PROT        1 1797.2
- ISOTYPEIgG  1 1797.4
- BMPC        1 1797.7
&lt;none&gt;          1798.3
- AGE         1 1800.0
- ALB         1 1801.8
- MRI         1 1802.7
- B2M         1 1805.6
- Cyto_Abn    1 1807.2
- LDH         1 1815.2

Step:  AIC=1796.4
Surv(OS_Time, OS_Censor) ~ AGE + PROT + B2M + ISOTYPEIgA + ISOTYPEIgG + 
    CRP + CREAT + LDH + ALB + ASPC + BMPC + MRI + Cyto_Abn

             Df    AIC
- CRP         1 1794.6
- CREAT       1 1794.8
- ASPC        1 1794.9
- ISOTYPEIgA  1 1795.2
- PROT        1 1795.4
- ISOTYPEIgG  1 1795.4
- BMPC        1 1795.7
&lt;none&gt;          1796.4
- AGE         1 1798.1
- ALB         1 1799.9
- MRI         1 1800.9
- B2M         1 1803.6
- Cyto_Abn    1 1805.2
- LDH         1 1813.2

Step:  AIC=1794.62
Surv(OS_Time, OS_Censor) ~ AGE + PROT + B2M + ISOTYPEIgA + ISOTYPEIgG + 
    CREAT + LDH + ALB + ASPC + BMPC + MRI + Cyto_Abn

             Df    AIC
- CREAT       1 1793.0
- ASPC        1 1793.1
- ISOTYPEIgA  1 1793.4
- PROT        1 1793.5
- ISOTYPEIgG  1 1793.7
- BMPC        1 1794.0
&lt;none&gt;          1794.6
- AGE         1 1796.4
- ALB         1 1797.9
- MRI         1 1799.0
- B2M         1 1801.7
- Cyto_Abn    1 1803.3
- LDH         1 1811.3

Step:  AIC=1793.01
Surv(OS_Time, OS_Censor) ~ AGE + PROT + B2M + ISOTYPEIgA + ISOTYPEIgG + 
    LDH + ALB + ASPC + BMPC + MRI + Cyto_Abn

             Df    AIC
- ASPC        1 1791.5
- ISOTYPEIgA  1 1791.8
- PROT        1 1791.9
- ISOTYPEIgG  1 1792.0
- BMPC        1 1792.5
&lt;none&gt;          1793.0
- AGE         1 1795.2
- ALB         1 1796.8
- MRI         1 1797.3
- Cyto_Abn    1 1801.9
- B2M         1 1806.1
- LDH         1 1809.4

Step:  AIC=1791.47
Surv(OS_Time, OS_Censor) ~ AGE + PROT + B2M + ISOTYPEIgA + ISOTYPEIgG + 
    LDH + ALB + BMPC + MRI + Cyto_Abn

             Df    AIC
- PROT        1 1790.2
- ISOTYPEIgA  1 1790.3
- ISOTYPEIgG  1 1790.5
- BMPC        1 1790.5
&lt;none&gt;          1791.5
- AGE         1 1793.5
- ALB         1 1795.1
- MRI         1 1796.1
- Cyto_Abn    1 1800.0
- B2M         1 1804.3
- LDH         1 1807.6

Step:  AIC=1790.16
Surv(OS_Time, OS_Censor) ~ AGE + B2M + ISOTYPEIgA + ISOTYPEIgG + 
    LDH + ALB + BMPC + MRI + Cyto_Abn

             Df    AIC
- ISOTYPEIgA  1 1789.2
- BMPC        1 1789.2
- ISOTYPEIgG  1 1789.3
&lt;none&gt;          1790.2
- AGE         1 1792.1
- ALB         1 1793.6
- MRI         1 1794.7
- Cyto_Abn    1 1798.5
- B2M         1 1803.1
- LDH         1 1807.3

Step:  AIC=1789.18
Surv(OS_Time, OS_Censor) ~ AGE + B2M + ISOTYPEIgG + LDH + ALB + 
    BMPC + MRI + Cyto_Abn

             Df    AIC
- ISOTYPEIgG  1 1787.4
- BMPC        1 1788.5
&lt;none&gt;          1789.2
- AGE         1 1791.1
- MRI         1 1793.0
- ALB         1 1793.2
- Cyto_Abn    1 1798.9
- B2M         1 1801.4
- LDH         1 1805.3

Step:  AIC=1787.39
Surv(OS_Time, OS_Censor) ~ AGE + B2M + LDH + ALB + BMPC + MRI + 
    Cyto_Abn

           Df    AIC
- BMPC      1 1786.6
&lt;none&gt;        1787.4
- AGE       1 1789.5
- MRI       1 1791.1
- ALB       1 1792.4
- Cyto_Abn  1 1797.6
- B2M       1 1799.4
- LDH       1 1803.3

Step:  AIC=1786.63
Surv(OS_Time, OS_Censor) ~ AGE + B2M + LDH + ALB + MRI + Cyto_Abn

           Df    AIC
&lt;none&gt;        1786.6
- AGE       1 1788.4
- MRI       1 1789.8
- ALB       1 1792.0
- Cyto_Abn  1 1798.2
- B2M       1 1802.4
- LDH       1 1803.7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparar los modelos usando AIC</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>estadisticoAIC <span class="ot">&lt;-</span> <span class="fu">AIC</span>(modelo_exp, modelo_exp_backward ,modelo_weibull, modelo_weibull_backward ,modelo_lognormal, modelo_lognormal_backward ,modelo_loglogistic,modelo_loglogistic_backward, modelo_inicial, modelo_backward)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparar los modelos usando BIC</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>estadisticoBIC <span class="ot">&lt;-</span> <span class="fu">BIC</span>(modelo_exp, modelo_exp_backward ,modelo_weibull, modelo_weibull_backward ,modelo_lognormal, modelo_lognormal_backward ,modelo_loglogistic,modelo_loglogistic_backward, modelo_inicial, modelo_backward)</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>estadisticoAIC</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            df      AIC
modelo_exp                  18 1814.419
modelo_exp_backward          7 1796.860
modelo_weibull              19 1811.101
modelo_weibull_backward      8 1793.009
modelo_lognormal            19 1806.233
modelo_lognormal_backward    9 1789.851
modelo_loglogistic          19 1804.328
modelo_loglogistic_backward  8 1786.633
modelo_inicial              16 1717.114
modelo_backward              7 1700.269</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>estadisticoBIC</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            df      BIC
modelo_exp                  18 1889.053
modelo_exp_backward          7 1825.884
modelo_weibull              19 1889.881
modelo_weibull_backward      8 1826.180
modelo_lognormal            19 1885.014
modelo_lognormal_backward    9 1827.168
modelo_loglogistic          19 1883.108
modelo_loglogistic_backward  8 1819.804
modelo_inicial              16 1765.912
modelo_backward              7 1721.618</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar el resumen del modelo</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_loglogistic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
survreg(formula = Surv(OS_Time, OS_Censor) ~ AGE + SEX + PROT + 
    B2M + ISOTYPEFLC + ISOTYPEIgA + ISOTYPEIgD + ISOTYPEIgG + 
    CRP + CREAT + LDH + ALB + HGB + ASPC + BMPC + MRI + Cyto_Abn, 
    data = Arkansas_SinDatosFaltantes, dist = "loglogistic")
               Value Std. Error     z       p
(Intercept)  5.61215    0.90913  6.17 6.7e-10
AGE         -0.01482    0.00789 -1.88  0.0604
SEXmale     -0.01789    0.15647 -0.11  0.9090
PROTTT3      0.16204    0.17554  0.92  0.3560
B2M         -0.06119    0.01975 -3.10  0.0019
ISOTYPEFLC   0.24332    0.24955  0.98  0.3296
ISOTYPEIgA   0.00907    0.17241  0.05  0.9580
ISOTYPEIgD   0.15497    0.82844  0.19  0.8516
ISOTYPEIgG        NA    0.00000    NA      NA
CRP          0.00168    0.00381  0.44  0.6602
CREAT        0.04742    0.07595  0.62  0.5324
LDH         -0.00471    0.00109 -4.33 1.5e-05
ALB          0.33230    0.14421  2.30  0.0212
HGB         -0.01024    0.04855 -0.21  0.8330
ASPC         0.00284    0.00422  0.67  0.5009
BMPC        -0.00469    0.00400 -1.17  0.2417
MRI         -0.01248    0.00499 -2.50  0.0124
Cyto_Abn    -0.50483    0.15546 -3.25  0.0012
Log(scale)  -0.35317    0.07125 -4.96 7.2e-07

Scale= 0.702 

Log logistic distribution
Loglik(model)= -883.2   Loglik(intercept only)= -935.7
    Chisq= 104.98 on 17 degrees of freedom, p= 1.1e-14 
Number of Newton-Raphson Iterations: 4 
n= 467 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>modelo_loglogistic_backward <span class="ot">&lt;-</span> <span class="fu">step</span>(modelo_loglogistic, <span class="at">direction =</span> <span class="st">"backward"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=1804.33
Surv(OS_Time, OS_Censor) ~ AGE + SEX + PROT + B2M + ISOTYPEFLC + 
    ISOTYPEIgA + ISOTYPEIgD + ISOTYPEIgG + CRP + CREAT + LDH + 
    ALB + HGB + ASPC + BMPC + MRI + Cyto_Abn

             Df    AIC
- ISOTYPEFLC  1 1802.3
- ISOTYPEIgA  1 1802.3
- ISOTYPEIgD  1 1802.3
- ISOTYPEIgG  1 1802.3
- SEX         1 1802.3
- HGB         1 1802.4
- CRP         1 1802.5
- CREAT       1 1802.7
- ASPC        1 1802.8
- PROT        1 1803.2
- BMPC        1 1803.7
&lt;none&gt;          1804.3
- AGE         1 1805.9
- ALB         1 1807.7
- MRI         1 1808.5
- B2M         1 1811.3
- Cyto_Abn    1 1813.0
- LDH         1 1821.1

Step:  AIC=1802.33
Surv(OS_Time, OS_Censor) ~ AGE + SEX + PROT + B2M + ISOTYPEIgA + 
    ISOTYPEIgD + ISOTYPEIgG + CRP + CREAT + LDH + ALB + HGB + 
    ASPC + BMPC + MRI + Cyto_Abn

             Df    AIC
- ISOTYPEIgD  1 1800.3
- SEX         1 1800.3
- HGB         1 1800.4
- CRP         1 1800.5
- CREAT       1 1800.7
- ASPC        1 1800.8
- ISOTYPEIgA  1 1801.1
- PROT        1 1801.2
- ISOTYPEIgG  1 1801.3
- BMPC        1 1801.7
&lt;none&gt;          1802.3
- AGE         1 1803.9
- ALB         1 1805.7
- MRI         1 1806.5
- B2M         1 1809.3
- Cyto_Abn    1 1811.0
- LDH         1 1819.1

Step:  AIC=1800.34
Surv(OS_Time, OS_Censor) ~ AGE + SEX + PROT + B2M + ISOTYPEIgA + 
    ISOTYPEIgG + CRP + CREAT + LDH + ALB + HGB + ASPC + BMPC + 
    MRI + Cyto_Abn

             Df    AIC
- SEX         1 1798.3
- HGB         1 1798.4
- CRP         1 1798.5
- CREAT       1 1798.7
- ASPC        1 1798.8
- ISOTYPEIgA  1 1799.2
- PROT        1 1799.2
- ISOTYPEIgG  1 1799.3
- BMPC        1 1799.7
&lt;none&gt;          1800.3
- AGE         1 1802.0
- ALB         1 1803.7
- MRI         1 1804.5
- B2M         1 1807.4
- Cyto_Abn    1 1809.0
- LDH         1 1817.1

Step:  AIC=1798.35
Surv(OS_Time, OS_Censor) ~ AGE + PROT + B2M + ISOTYPEIgA + ISOTYPEIgG + 
    CRP + CREAT + LDH + ALB + HGB + ASPC + BMPC + MRI + Cyto_Abn

             Df    AIC
- HGB         1 1796.4
- CRP         1 1796.5
- CREAT       1 1796.7
- ASPC        1 1796.8
- ISOTYPEIgA  1 1797.2
- PROT        1 1797.2
- ISOTYPEIgG  1 1797.4
- BMPC        1 1797.7
&lt;none&gt;          1798.3
- AGE         1 1800.0
- ALB         1 1801.8
- MRI         1 1802.7
- B2M         1 1805.6
- Cyto_Abn    1 1807.2
- LDH         1 1815.2

Step:  AIC=1796.4
Surv(OS_Time, OS_Censor) ~ AGE + PROT + B2M + ISOTYPEIgA + ISOTYPEIgG + 
    CRP + CREAT + LDH + ALB + ASPC + BMPC + MRI + Cyto_Abn

             Df    AIC
- CRP         1 1794.6
- CREAT       1 1794.8
- ASPC        1 1794.9
- ISOTYPEIgA  1 1795.2
- PROT        1 1795.4
- ISOTYPEIgG  1 1795.4
- BMPC        1 1795.7
&lt;none&gt;          1796.4
- AGE         1 1798.1
- ALB         1 1799.9
- MRI         1 1800.9
- B2M         1 1803.6
- Cyto_Abn    1 1805.2
- LDH         1 1813.2

Step:  AIC=1794.62
Surv(OS_Time, OS_Censor) ~ AGE + PROT + B2M + ISOTYPEIgA + ISOTYPEIgG + 
    CREAT + LDH + ALB + ASPC + BMPC + MRI + Cyto_Abn

             Df    AIC
- CREAT       1 1793.0
- ASPC        1 1793.1
- ISOTYPEIgA  1 1793.4
- PROT        1 1793.5
- ISOTYPEIgG  1 1793.7
- BMPC        1 1794.0
&lt;none&gt;          1794.6
- AGE         1 1796.4
- ALB         1 1797.9
- MRI         1 1799.0
- B2M         1 1801.7
- Cyto_Abn    1 1803.3
- LDH         1 1811.3

Step:  AIC=1793.01
Surv(OS_Time, OS_Censor) ~ AGE + PROT + B2M + ISOTYPEIgA + ISOTYPEIgG + 
    LDH + ALB + ASPC + BMPC + MRI + Cyto_Abn

             Df    AIC
- ASPC        1 1791.5
- ISOTYPEIgA  1 1791.8
- PROT        1 1791.9
- ISOTYPEIgG  1 1792.0
- BMPC        1 1792.5
&lt;none&gt;          1793.0
- AGE         1 1795.2
- ALB         1 1796.8
- MRI         1 1797.3
- Cyto_Abn    1 1801.9
- B2M         1 1806.1
- LDH         1 1809.4

Step:  AIC=1791.47
Surv(OS_Time, OS_Censor) ~ AGE + PROT + B2M + ISOTYPEIgA + ISOTYPEIgG + 
    LDH + ALB + BMPC + MRI + Cyto_Abn

             Df    AIC
- PROT        1 1790.2
- ISOTYPEIgA  1 1790.3
- ISOTYPEIgG  1 1790.5
- BMPC        1 1790.5
&lt;none&gt;          1791.5
- AGE         1 1793.5
- ALB         1 1795.1
- MRI         1 1796.1
- Cyto_Abn    1 1800.0
- B2M         1 1804.3
- LDH         1 1807.6

Step:  AIC=1790.16
Surv(OS_Time, OS_Censor) ~ AGE + B2M + ISOTYPEIgA + ISOTYPEIgG + 
    LDH + ALB + BMPC + MRI + Cyto_Abn

             Df    AIC
- ISOTYPEIgA  1 1789.2
- BMPC        1 1789.2
- ISOTYPEIgG  1 1789.3
&lt;none&gt;          1790.2
- AGE         1 1792.1
- ALB         1 1793.6
- MRI         1 1794.7
- Cyto_Abn    1 1798.5
- B2M         1 1803.1
- LDH         1 1807.3

Step:  AIC=1789.18
Surv(OS_Time, OS_Censor) ~ AGE + B2M + ISOTYPEIgG + LDH + ALB + 
    BMPC + MRI + Cyto_Abn

             Df    AIC
- ISOTYPEIgG  1 1787.4
- BMPC        1 1788.5
&lt;none&gt;          1789.2
- AGE         1 1791.1
- MRI         1 1793.0
- ALB         1 1793.2
- Cyto_Abn    1 1798.9
- B2M         1 1801.4
- LDH         1 1805.3

Step:  AIC=1787.39
Surv(OS_Time, OS_Censor) ~ AGE + B2M + LDH + ALB + BMPC + MRI + 
    Cyto_Abn

           Df    AIC
- BMPC      1 1786.6
&lt;none&gt;        1787.4
- AGE       1 1789.5
- MRI       1 1791.1
- ALB       1 1792.4
- Cyto_Abn  1 1797.6
- B2M       1 1799.4
- LDH       1 1803.3

Step:  AIC=1786.63
Surv(OS_Time, OS_Censor) ~ AGE + B2M + LDH + ALB + MRI + Cyto_Abn

           Df    AIC
&lt;none&gt;        1786.6
- AGE       1 1788.4
- MRI       1 1789.8
- ALB       1 1792.0
- Cyto_Abn  1 1798.2
- B2M       1 1802.4
- LDH       1 1803.7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_loglogistic_backward)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
survreg(formula = Surv(OS_Time, OS_Censor) ~ AGE + B2M + LDH + 
    ALB + MRI + Cyto_Abn, data = Arkansas_SinDatosFaltantes, 
    dist = "loglogistic")
               Value Std. Error     z       p
(Intercept)  5.41031    0.71932  7.52 5.4e-14
AGE         -0.01472    0.00765 -1.92 0.05437
B2M         -0.05131    0.01161 -4.42 9.8e-06
LDH         -0.00441    0.00102 -4.33 1.5e-05
ALB          0.33911    0.12563  2.70 0.00695
MRI         -0.01062    0.00463 -2.29 0.02184
Cyto_Abn    -0.53575    0.14697 -3.65 0.00027
Log(scale)  -0.35867    0.07007 -5.12 3.1e-07

Scale= 0.699 

Log logistic distribution
Loglik(model)= -885.3   Loglik(intercept only)= -935.7
    Chisq= 100.67 on 6 degrees of freedom, p= 1.8e-19 
Number of Newton-Raphson Iterations: 4 
n= 467 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>estadisticoAIC <span class="ot">&lt;-</span> <span class="fu">AIC</span>(modelo_exp, modelo_weibull, modelo_lognormal, modelo_loglogistic, modelo_backward, modelo_inicial, modelo_loglogistic_backward)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparar los modelos usando BIC</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>estadisticoBIC <span class="ot">&lt;-</span> <span class="fu">BIC</span>(modelo_exp, modelo_weibull, modelo_lognormal, modelo_loglogistic, modelo_backward, modelo_inicial, modelo_loglogistic_backward)</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>estadisticoAIC</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            df      AIC
modelo_exp                  18 1814.419
modelo_weibull              19 1811.101
modelo_lognormal            19 1806.233
modelo_loglogistic          19 1804.328
modelo_backward              7 1700.269
modelo_inicial              16 1717.114
modelo_loglogistic_backward  8 1786.633</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>estadisticoBIC</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            df      BIC
modelo_exp                  18 1889.053
modelo_weibull              19 1889.881
modelo_lognormal            19 1885.014
modelo_loglogistic          19 1883.108
modelo_backward              7 1721.618
modelo_inicial              16 1765.912
modelo_loglogistic_backward  8 1819.804</code></pre>
</div>
</div>
</section>
</section>
<section id="otros" class="level1">
<h1>OTROS</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>grafico_B2M_puntos <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(Arkansas, <span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">564</span>)) <span class="sc">+</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> B2M), <span class="at">color =</span> <span class="st">"#56B4E9"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">xmin =</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">xmax =</span> <span class="dv">570</span>, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> <span class="fl">2.7</span>, <span class="at">alpha =</span> <span class="fl">0.35</span>,, <span class="at">fill =</span> <span class="st">"lightgreen"</span>) <span class="sc">+</span>  <span class="co"># Cambiado el color del rectángulo</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">xmax =</span> <span class="cn">Inf</span>, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> <span class="dv">0</span>, <span class="at">fill =</span> <span class="st">"Niveles Normales"</span>), ) <span class="sc">+</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">" "</span>, <span class="at">values =</span> <span class="st">"lightgreen"</span> )<span class="sc">+</span></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Diagrama de puntos de B2M"</span>,</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"*Algunos valores no han sido representados </span><span class="sc">\n</span><span class="st"> por ser demasiado elevados"</span>,</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="cn">NULL</span>,  <span class="co"># Eliminar etiqueta del eje x</span></span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"B2M"</span>) <span class="sc">+</span></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">15</span>) <span class="sc">+</span>  <span class="co"># Ajuste del eje Y</span></span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> numero_observaciones<span class="sc">/</span><span class="dv">2</span> , <span class="at">y =</span> <span class="sc">-</span><span class="dv">1</span>, </span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Sanos: "</span>, proporcionB2M_sano ,<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>,<span class="st">"Mal: "</span>, proporcionB2M_mal)),</span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"black"</span>)<span class="sc">+</span></span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),  <span class="co"># Eliminar título del eje x</span></span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>()     <span class="co"># Eliminar texto del eje x</span></span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'GGally':
  method from   
  +.gg   ggplot2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a> d_b<span class="ot">&lt;-</span> Arkansas <span class="sc">%&gt;%</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(SEX,B2M,CRP,CREAT, LDH, ALB,HGB)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>d_b <span class="sc">%&gt;%</span> <span class="fu">ggpairs</span>(<span class="fu">aes</span>(<span class="at">color =</span> SEX ,<span class="at">alpha =</span> <span class="fl">0.7</span>),</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">upper =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="fu">wrap</span>(<span class="st">"cor"</span>, <span class="at">size =</span> <span class="fl">2.5</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing non-finite outside the scale range
(`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4 rows containing non-finite outside the scale range
(`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 3 rows containing non-finite outside the scale range
(`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing non-finite outside the scale range
(`stat_bin()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing non-finite outside the scale range
(`stat_density()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in ggally_statistic(data = data, mapping = mapping, na.rm = na.rm, :
Removed 5 rows containing missing values</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in ggally_statistic(data = data, mapping = mapping, na.rm = na.rm, :
Removed 4 rows containing missing values</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in ggally_statistic(data = data, mapping = mapping, na.rm = na.rm, :
Removing 1 row that contained a missing value
Warning in ggally_statistic(data = data, mapping = mapping, na.rm = na.rm, :
Removing 1 row that contained a missing value
Warning in ggally_statistic(data = data, mapping = mapping, na.rm = na.rm, :
Removing 1 row that contained a missing value</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4 rows containing non-finite outside the scale range
(`stat_bin()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 5 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4 rows containing non-finite outside the scale range
(`stat_density()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in ggally_statistic(data = data, mapping = mapping, na.rm = na.rm, :
Removed 7 rows containing missing values</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in ggally_statistic(data = data, mapping = mapping, na.rm = na.rm, :
Removed 4 rows containing missing values
Warning in ggally_statistic(data = data, mapping = mapping, na.rm = na.rm, :
Removed 4 rows containing missing values
Warning in ggally_statistic(data = data, mapping = mapping, na.rm = na.rm, :
Removed 4 rows containing missing values</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 3 rows containing non-finite outside the scale range
(`stat_bin()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 7 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 3 rows containing non-finite outside the scale range
(`stat_density()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in ggally_statistic(data = data, mapping = mapping, na.rm = na.rm, :
Removed 3 rows containing missing values
Warning in ggally_statistic(data = data, mapping = mapping, na.rm = na.rm, :
Removed 3 rows containing missing values
Warning in ggally_statistic(data = data, mapping = mapping, na.rm = na.rm, :
Removed 3 rows containing missing values</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 3 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 3 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 3 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03.PrubasDeModelos_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Arkansas)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "original order" "PATID"          "PROT"           "SEX"           
 [5] "RACE"           "ISOTYPE"        "AGE"            "B2M"           
 [9] "CRP"            "CREAT"          "LDH"            "ALB"           
[13] "HGB"            "ASPC"           "BMPC"           "MRI"           
[17] "Cyto_Abn"       "CPS1"           "CPR1"           "EFS_Censor"    
[21] "EFS_Time"       "OS_Censor"      "OS_Time"        "AGE_flag"      
[25] "B2M_flag"       "CREAT_flag"     "CRP_flag"       "LDH_flag"      
[29] "ALB_flag"       "MRI_flag"       "HGB_flag"      </code></pre>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>